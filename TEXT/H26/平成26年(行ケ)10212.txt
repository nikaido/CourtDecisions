主文
  1 原告の請求を棄却する。
  2 訴訟費用は原告の負担とする。
  3 この判決に対する上告及び上告受理の申立てのための付加期間を30日と定める。

事実及び理由
第1 請求
  特許庁が不服2012-16391号事件について平成26年4月30日にした審決を取り消す。
第2 事案の概要
  1 特許庁における手続の経緯等
    (1)
      原告は，発明の名称を「電気通信システムにおける方法および構成」とする発明について，2008年(平成20年)5月20日(優先権主張日2007年(平成19年)9月17日，米国)を国際出願日とする特許出願(特願2010-524820号。以下「本願」という。)をした。
      原告は，平成24年4月19日付けの拒絶査定(甲7)を受けたため，同年8月23日，拒絶査定不服審判を請求した。
    (2)
      特許庁は，上記請求を不服2012-16391号事件として審理を行い，平成26年4月30日，「本件審判の請求は，成り立たない。」との審決(出訴期間の付加期間90日。以下「本件審決」という。)をし，同年5月12日，その謄本が原告に送達された。
    (3)
      原告は，平成26年9月9日，本件審決の取消しを求める本件訴訟を提起した。
  2 特許請求の範囲の記載
    本願の特許請求の範囲の請求項1の記載は，次のとおりである(以下，請求項1に係る発明を「本願発明」という。甲4)。
    「【請求項1】  次世代パケットシステムEPSのモビリティ管理エンティティ(13)MMEにおいて，ユーザ装置(11)UEと前記UEにサービスするeＮodeB(12)との間のRRC／UPトラフィックを保護するためにセキュリティキーK＿eＮBを確立する方法であって，以下の
    -  ＮASサービス要求を前記UEから受信するステップ(32，52)であって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップと，
    -  少なくとも前記受信されたＮAS＿U＿SEQから，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ(33，53)と，
    -  前記導出されたK＿eＮBを，前記UEにサービスする前記eＮodeB(12)に転送するステップ(34)と，を含む，MMEにおける方法。」
  3 本件審決の理由の要旨
    (1)
      本件審決の理由は，別紙審決書(写し)記載のとおりである。要するに，本願発明は，本願の優先権主張日前に頒布された刊行物に記載された発明又は電気通信回線を通じて公衆に利用可能となった発明，すなわち，「3GPP，Universal Mobile Telecommunications System (UMTS);Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access (E-UTRAN);Overall description;Stage 2(3GPP TS 36.300 version 8.1.0 Release 8)，[online]，2007年  6月，p.11-15， 58，59；URL，http://www.etsi.org/deliver/etsi_ts/136300_136399/136300/08.01.00_60/ts_136300v080100p.pdf」(以下「引用刊行物1」又は「3GPP TS 36.300 version 8.1.0 Release 8」という。甲1)に掲載された発明等に基づいて当業者が容易に発明をすることができたものであって，特許法29条2項の規定により特許を受けることができないから，本願は拒絶すべきものであるというものである。
    (2)
      本件審決が認定した引用刊行物1に記載された発明(以下「引用発明」という。)，本願発明と引用発明の一致点及び相違点は，以下のとおりである。
      ア 引用発明
        「UEと，UEに対する資源の動的配置，ユーザ・データ・ストリームを暗号化するeＮBと，eＮBへのページング・メッセージの分配，セキュリティ制御，及び，ＮAS信号伝達の暗号化と完全性保護を行うMMEとを有する無線通信システムにおいて，
        UEとMMEは，K＿ASMEという名の基本鍵を共有し，前記K＿ASMEからK＿eＮBが得られ，
        前記K＿eＮBを得るために，シーケンス番号が使用され，
        前記K＿eＮBは，MMEから，eＮBに送信される，方法。」
      イ 本願発明と引用発明の一致点
        「次世代パケットシステムEPSのモビリティ管理エンティティMMEにおいて，ユーザ装置UEと前記UEにサービスするeＮodeBとの間のRRC／UPトラフィックを保護するためにセキュリティキーK＿eＮBを確立する方法であって，
        シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップと，
        前記導出されたK＿eＮBを，前記UEにサービスする前記eＮodeBに転送するステップ，とを含む方法。」である点。
      ウ 本願発明と引用発明の相違点
        “シーケンス番号”に関して，
        本願発明においては，「ＮASサービス要求を前記UEから受信するステップ(32，52)であって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップ」において，「UE」側から「MME」側が受信する「アップリンクシーケンス番号」であるのに対して，
        引用発明においては，「シーケンス番号」が，「UE」から，「MME」への「アップリンクシーケンス番号」であるか否かが明確でない点。
第3 当事者の主張
  1 原告の主張
    (1) 取消事由1(引用発明及び一致点の認定の誤り)
      引用刊行物1(甲1)には，「K＿eＮB」を得るために，「シーケンス番号」(sequence number)が使用される構成についての開示はないから，本件審決が認定した引用発明のうち，「前記K＿eＮBを得るために，シーケンス番号が使用され」との部分は誤りであり，本件審決が引用発明が上記部分の構成を有することを前提に，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」を本願発明と引用発明の一致点と認定したことも誤りである。
      ア 引用発明の認定の誤り
        本件審決は，引用刊行物1(甲1)の「A given sequence number must only be used once for a given eNB key」との記載を「得られたシーケンス番号は，eＮB鍵を得るために使用されるのは，一度のみでなければならない」と和訳(以下「本件和訳」という場合がある。)した上で，上記記載箇所から「“eＮB鍵を得るために，シーケンス番号が使用される”ことが読み取れる。」と認定したが，以下のとおり誤りである。
        (ア)
          引用刊行物1の「A given sequence number must only be used once for a given eNB key」との記載は，「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，一度のみでなければならない」と訳すべきである。上記記載中の「for a given eNB key」の部分を本件和訳のように「eＮB鍵を得るために」を意味すると解する余地はない。仮に「得るために」と英語表記するのであれば，「to get」，「to obtain」又は「to derive」などの語を用いるはずであるが，そのような語は用いられていない。
          したがって，本件審決が上記記載箇所について本件和訳をし，上記記載箇所から「“eＮB鍵を得るために，シーケンス番号が使用される”ことが読み取れる。」と認定したのは誤りである。
        (イ)
          次に，「A given sequence number must only be used once for a given eNB key」との記載の前後の文脈からみても，本件和訳は誤りである。
          a
            引用刊行物1の「14 Security」の「14.1 Overview and Principles」(「14  セキュリティ」の「14．1  概説及び原則」)には，以下のとおり，E-UTRAＮのセキュリティに適用される6つの原則(「第1原則」ないし「第6原則」)が記載されており，「A given sequence number must only be used once for a given eNB key」との記載は，第5原則の第2文の一部である。
            「- The eNB keys are cryptographically separated from the EPC keys used for NAS protection (making it impossible to use the eNB key to figure out an EPC key).」(以下「第1原則」という。)
            「- The keys are derived in the EPC/UE from key material that was generated by a NAS (EPC/UE) level AKA procedure.」(以下「第2原則」という。)
            「- The eNB keys are sent from the EPC to the eNB when the UE is entering LTE_ACTIVE state (i.e. during RRCconnection or S1 context setup).」(以下「第3原則」という。)
            「- Key material for the eNB keys is sent between the eNBs during LTE_ACTIVE intra-E-UTRAN mobility.」(以下「第4原則」という。)
            「- A sequence number is used as input to the ciphering and integrity protection. A given sequence number must only be used once for a given eNB key (except for identical re-transmission). The same sequence number can be used for both ciphering and integrity protection.」(以下「第5原則」という。)
            「- A hyper frame number (HFN) (i.e. an overflow counter mechanism) is used in the eNB and UE in order to limit the actual number of sequence number bits that is needed to be sent over the radio. The HFN needs to be synchronized between the UE and eNB.」(以下「第6原則」という。)
          b
            引用刊行物1の「14．1  概説及び原則」は，E-UTRAＮのセキュリティ手続全体の概説及び原則を述べたものである。
            「14．1  概説及び原則」記載の第1原則ないし第4原則はeＮB鍵の生成や配送について，第5原則は，鍵を用いて暗号化及び完全性保護を実現すること，当該手続にシーケンス番号を用いることについて，第6原則はHFＮの取り決めについてそれぞれ述べたものである。
            第5原則は，第1文において「A sequence number is used as input to the ciphering and integrity protection.」(「シーケンス番号は，暗号化及び完全性保護のための入力として用いられる。」)と記載し，第3文において「The same sequence number can be used for both ciphering and integrity protection.」(「同一のシーケンス番号が，暗号化と完全性保護の両方に用いることができる。」)と記載しているように，暗号化及び完全性保護の手続，すなわち「鍵を用いる」手続について述べたものであるから，その第2文である「A given sequence number must only be used once for a given eNB key」についても，同様に暗号化及び完全性保護の手続について述べたものと理解すべきであり，これを「鍵の生成」について述べたものと理解することは極めて不自然であって，恣意的な解釈であるといわざるを得ない。
c 
  「14．1  概説及び原則」の最終段落には，「From K_ASME, the NAS, (and indirectly) K_eNB keys are derived. The K_ASME never leaves the EPC, but the K_eNB key is transported to the eNB from the EPC when the UE transitions to LTE_ACTIVE. From the K_eNB, the eNB and UE can derive the UP and RRC keys.」(「K＿ASMEから，ＮAS(そして，間接的に)，K＿eＮBが得られる。K＿ASMEは，決して，EPCから離れない。しかしながら，K＿eＮB鍵は，UEが，LTE＿ACTIVEに移行すると，EPCからeＮBに運ばれる。K＿eＮBから，eＮB，及び，UEは，UP，及び，RRC鍵を得ることができる。」)との記載がある。この記載から，EPCにおいて得られたK＿eＮBがeＮBに運ばれ，eＮB及びUEにおいて，当該K＿eＮBを基にしてUP鍵及びRRC鍵を得ていることが明らかである。
  そして，UEとeＮB間のプロトコルで用いられる鍵は，引用刊行物1の「Figure 14.1-1」(別紙1参照)に示すとおり，K＿eＮBの下位の鍵であるK (UP鍵)，K (RRC鍵)eＮB-UP-enc eＮB-RRC-enc及びK (RRC鍵)であり，このうち，K 及eＮB-RRC-int eＮB-UP-encびK は暗号化に用いられる鍵である。
  eＮB-RRC-enc  また，引用刊行物1(3GPP TS 36.300 version 8.1.0 Release 8)の後のバージョンの甲8(3GPP TS 36.300 version 8.8.0 Release 8)に「A sequence number (COUNT) is used as input to the ciphering and integrity protection.」との記載があることからすると，第5原則の第2文中の「A given sequence number」にいう「sequence number」とは「COUＮT」を意味する。
  さらに，引用刊行物1の後のバージョンの甲9の1(3GPP TS 36.323 version 1.0.0 Release 8)には，シーケンス番号の一種である「COUＮT」が，暗号化及び完全性保護のパラメータとして，K ，RRCencK 及びK のようなeＮB鍵の下位の鍵と共に用いられるUPenc RRCintことが示されている。
  そうすると，第5原則は，第1文において，シーケンス番号が暗号化及び完全性保護の入力として用いられること，第2文において，ある所与のシーケンス番号が，(暗号化及び完全性保護に用いられる際に，)ある所与のeＮB鍵を基にして得られたUP鍵(K )及びeＮB-UP-encRRC鍵(K ，K )のために用いられるのはeＮB-RRC-enc eＮB-RRC-int一度でなければならないこと，第3文において，所与のeＮB鍵(正確には，その下位のUP鍵及びRRC鍵)が暗号化及び完全性保護の手続に用いられることを述べたものといえる。
d 
  以上によれば，引用刊行物1の「A given sequence number must only be used once for a given eNB key」(第5原則第2文)との記載は，暗号化及び完全性保護の手続について述べたものであって，シーケンス番号がeＮB鍵の生成のために用いられることを述べたものではないから，本件審決がした本件和訳は誤りである。
  (ウ)
    以上のとおり，本件審決が引用刊行物1の「A given sequence number must only be used once for a given eNB key」(第5原則第2文)との記載について本件和訳をし，上記記載箇所から「“eＮB鍵を得るために，シーケンス番号が使用される”ことが読み取れる。」と認定したのは誤りである。
    引用刊行物1には，他に「K＿eＮB」を導出する手法についての開示はないから，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示はない。
    したがって，本件審決が認定した引用発明のうち，「前記K＿eＮBを得るために，シーケンス番号が使用され」との部分は誤りである。
    イ 一致点の認定の誤り
      本件審決が，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」を本願発明と引用発明の一致点と認定したのは誤りである。
  (ア)
    前記ア(ウ)のとおり，引用刊行物1には，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示はないから，引用発明は，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」の構成を有するものとはいえない。
    したがって，本件審決が上記構成を本願発明と引用発明の一致点と認定したのは誤りである。
  (イ)
a 
  本願の優先権主張日時点における当業者の技術常識によれば，引用発明における「シーケンス番号」には，本願発明の「ＮAS＿U＿SEQ」は含まれない。
  すなわち，前記ア(イ)cのとおり，引用刊行物1記載の第5原則の第2文中の「A given sequence number」にいう「sequence number」とは，「COUＮT」を意味するものであり，「COUＮT」はHFＮ及びPDCPシーケンス番号から構成されるものであるから，「ＮAS＿U＿SEQ」とは異なるシーケンス番号である。
  また，第5原則は，「E-UTRAＮ」すなわち「UE」と「eＮB」間のネットワークのセキュリティについて述べたものであるのに対し(引用刊行物1のFigure4)(別紙1参照)，「ＮAS」は，「UE」と「MME」との間のプロトコルであり(同Figure4.3.2)(別紙1参照)，本願発明と引用発明とは，「シーケンス番号」が用いられるプロトコルが異なるから，「シーケンス番号」の意味が異なることは，当業者にとって自明である。
  したがって，引用発明における「シーケンス番号」には，本願発明の「ＮAS＿U＿SEQ」は含まれないから，本件審決が，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」を本願発明と引用発明の一致点と認定したのは誤りである。
b 
  被告は，これに対し，引用発明における「シーケンス番号」に「ＮAS＿U＿SEQ」が含まれる旨主張する。
  しかしながら，「シーケンス番号」という用語は，様々な場面で用いられるものであり，単に「シーケンス番号」といっても，その意味は一義的ではなく，一般的にシーケンス番号と整理されるものが全て引用発明における「シーケンス番号」に含まれるなどと解することはできない。
  被告は，単に抽象論を述べるのみで，具体的な論証を一切行っていないから，被告の上記主張は失当である。
      (2) 取消事由2(相違点の看過)
        本願発明は，「ＮASサービス要求を前記UEから受信するステップ(32，52)であって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップ」の構成を有するが，本件審決は，引用発明が上記構成を有することを認定していないから，上記構成を本願発明と引用発明の相違点として認定すべきであったのに，この相違点の認定を看過した誤りがある。
        そして，本件審決は，上記相違点の容易想到性について判断を示していない。
      (3) 取消事由3(相違点の容易想到性の判断の誤り)
        本件審決は，本件審決が認定した相違点について，引用発明，国際公開第2006／116620号(2006年11月2日公開。以下「引用刊行物2」という。甲2の1)に記載の発明及び周知技術も共に，無線通信におけるパケット伝送のセキュリティに関するものであるから，「シーケンス番号」を「UE」側から「MME」に送信する必要がある場合に，「シーケンス番号」を「UE」から「MME」に送信するよう構成することは，当業者が適宜なし得る事項であり，本願発明と引用発明との相違点は格別のものではない旨判断したが，以下に述べるとおり，本件審決の上記判断は誤りである。
    ア
  (ア)
    前記(1)ア(ウ)のとおり，引用刊行物1(甲1)には，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示はない。同様に，引用刊行物2(甲2の1)及び本件審決が認定した周知技術(「「UE」から，「MME」に対して「RRC／ＮAS信号」を送信する点」)のいずれにも，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示も示唆もない。
    また，仮に引用刊行物1に「K＿eＮBを得るために，シーケンス番号が使用され」る構成の開示があるとしても，引用刊行物1には，K＿eＮBを得るためにＮASサービス要求で示される「ＮAS＿U＿SEQ」をシーケンス番号として用いることの開示はない。同様に，引用刊行物2及び本件審決が認定した周知技術のいずれにおいても，ＮASサービス要求で示される「ＮAS＿U＿SEQ」をK＿eＮBの生成のために用いることについての開示や示唆はない。
    したがって，引用発明に引用刊行物2記載の発明及び本件審決が認定した構成を組み合わせても，当業者が相違点に係る本願発明の構成を容易に想到することができたものとはいえない。
  (イ)
    被告は，これに対し，乙2，4ないし7の記載を根拠として挙げて，シーケンス番号を使用して鍵を生成することによって効率的に鍵を共有することができることが，セキュリティの分野における技術常識であったこと，UEからのアップリンクにシーケンス番号が含まれていることは広く知られていることからすると，このようなアップリンクに含まれるシーケンス番号のうち，具体的に何を使用するかは，結局のところ，使用できるものの中から適宜選択すべきことにすぎないとして，当業者が相違点に係る本願発明の構成を容易に想到することができた旨主張する。
    しかしながら，被告の上記主張は，引用刊行物1に全く記載のない事項について，乙2，4ないし7に記載されていることを理由に引用刊行物1に同じことが記載されている旨主張するに等しいものであり，また，公知の技術について，何らの論証もないまま殊更引用刊行物1に開示された構成を上位概念化するものであって不当である。
    したがって，被告の上記主張は理由がない。
    イ
      本件審決は，本願発明と引用発明との相違点は格別のものではないと判断したが，その判断に際し，本願発明が引用発明と比べて顕著な効果を奏することを考慮していないから，上記判断は誤りである。
      すなわち，前記ア(ア)のとおり，引用刊行物1には，K＿eＮBを得るためにＮASサービス要求で示される「ＮAS＿U＿SEQ」をシーケンス番号として用いることの開示はない。
      これに対し，本願の願書に添付した明細書(以下，図面を含めて「本願明細書」という。甲4)には，「ＮAS＿D＿SEQ」を用いる場合には，「ＮASメッセージ」の損失に起因する「UEにおける誤ったＮAS＿D＿SEQ」に基づく「K＿eＮB」生成が行われるおそれがあり(段落【0007】)，また，「別個のシーケンス番号」を用いる場合には，「再生攻撃を防ぐために，別個のシーケンス番号をUEおよびMMEの両方において保持しなければならない」といった「特別な複雑さ」を要するが(段落【0008】)，本願発明は，「K＿eＮB」の生成に「ＮAS＿U＿SEQ」を使用することにより，「MMEからUEへの明示的なダウンリンクＮASサービス受理メッセージまたはシーケンス番号が必要ではないこと，およびＮASセキュリティコンテキストの再生保護機能が，RRCおよびUPセキュリティコンテキストにおいて再利用されること」(段落【0011】)といった顕著な効果を奏することが開示されている。
      しかるところ，本件審決は，本願発明の上記顕著な効果を考慮することなく，本願発明と引用発明との相違点は格別のものではないと判断したのであるから，本件審決の上記判断は誤りである。
    ウ
      以上によれば，本件審決における相違点の容易想到性の判断には誤りがある。
      (4) まとめ
        以上によれば，本件審決には，引用発明及び一致点の認定の誤り，相違点の看過，相違点の容易想到性の判断の誤りがあり，その結果，本件審決は，本願発明は特許法29条2項の規定により特許を受けることができないと誤った判断をしたものである。
        したがって，本件審決は，違法であるから，取り消されるべきものである。
        2 被告の主張
      (1) 取消事由1(引用発明及び一致点の認定の誤り)に対し
    ア 引用発明の認定について
  (ア)
    引用刊行物1がLTEに関する規格として発行された技術文書であることに照らせば，本件審決が，第5原則の第1文と第3文については，逐語的な直訳を示す一方で，第2文については「eＮB鍵を得るために…が使用される」と訳し，逐語的な直訳を示さなかったことは不適切であったものといえる。
    しかしながら，本件審決は，第5原則の第2文の「A given sequence number must only be used once for a given eNB key」の「for a given eNB key」との部分のみから「eＮB鍵を得るために」との訳を導いたわけではない。「use」の動詞は，「用いる」ないし「使用する」を意味するが，「use」の目的ないし態様は文脈によって異なる。第2文中の「be used…for a given eNB key」の「eＮB鍵のために使用される」との記載が，引用刊行物1の「14．1  概説及び原則」記載のeＮB鍵の生成，共有，配送について主として述べている文脈中に存在しており，「eＮB鍵の生成のために」使用される趣旨を含むことから，このことを踏まえて意訳し，文脈に即して「eＮB鍵を得るために…が使用される」と訳したものであり，誤訳ではない。
    すなわち，引用刊行物1の「14．1  概説及び原則」には，「E-UTRAＮのセキュリティに適用される」べき6つの「原則」(第1原則ないし第6原則)が記載されるとともに，AKA(判決注:認証及び鍵共有のためのプロトコル)実行の結果としてEPCとUEがK＿ASMEという名称の基本鍵を共有する旨，K＿ASMEからK＿eＮBが得られる旨，K＿ASMEはEPCから離れないのに対して，K＿eＮBは，(UEがLTE＿ACTIVEに移行すると)EPCからeＮBに運ばれる旨等が「概説」されている。そして，第1原則ないし第3原則は，「概説」された内容をさらに抽象化したものであり，第1原則には，(E-UTRAＮ(UE／eＮB)のセキュリティにおいて用いられる)eＮB鍵は，ＮAS保護のために用いられるEPC鍵から分離されることが，第2原則には，これらの「鍵」が「EPC／UE」において「鍵素材」から得られる(つまりEPCだけでなくUEにおいても鍵生成が行われる)とともに，その「鍵素材」は，「ＮASレベルAKA手続」によって生成される旨が，第3原則には，UEがLTE＿ACTIVE状態に入るとeＮB鍵がEPCからeＮBに送られる旨がそれぞれ示されており，また，第5原則には，「シーケンス番号」を用いることを前提として，第1文では「暗号化，及び，完全性保護のための入力」という最も抽象的なレベルでの目的ないし態様が示され，第2文では「あるeＮB鍵」につき「一度のみ」しか用いることができない旨及び第3文では同じシーケンス番号を暗号化と完全性保護の両方に用いることができる旨が示されているから，引用刊行物1の「14．1  概説及び原則」は，eＮB鍵の生成，共有，配送について主として述べたものといえる。
    また，第5原則は，K＿eＮBとその派生鍵(eＮB鍵)が，ＮAS保護のために用いられるEPC鍵から分離され，ＮASレベルで行われる「認証及び鍵共有」のために用いられない旨を示した第1原則を受けて，K＿eＮBが「認証及び鍵共有」の後の「暗号化」と「完全性保護」のために用いられる旨を述べたものである。要するに，第5原則は，第1原則の裏返しとして，K＿eＮBが「認証及び鍵共有」のために用いられることはなく，「暗号化」と「完全性保護」のために用いられることを示すとともに，そのようなK＿eＮBに関して，「暗号化」と「完全性保護」のために入力される「シーケンス番号」を本来独立であるべき複数の「鍵」間で共通に使用してはならないという原則(セキュリティの分野では当たり前のこと)を述べるとともに，「暗号化」のために用いた「シーケンス番号」を当該「暗号化」に用いた鍵と同じ鍵を用いてされる「完全性保護」においても用いることができることを述べたものである。
    さらに，シーケンス番号を使用して鍵を生成することによって効率的に鍵を共有することができることは，本願の優先権主張日当時，セキュリティの分野における技術常識であったものである。例えば，①乙4(国際公開2007／046376号)の段落【0027】，【0029】及び【0047】には，「所定の契機でカウントアップされる「鍵更新カウンタ値(Ｎc)」というシーケンス番号を使用して送信の際の暗号化のための暗号鍵Kcと受信の際の復号のための復号鍵Kcを生成していること」が，②乙5(特表2003-529288号公報)の段落【0004】ないし【0006】には，「暗号化送信に用いるキーを発生するにあたって，カウンタのカウント値Rというシーケンス番号を用いていること」が，③乙6(特開平11-109854号公報)の段落【0068】，【0072】，【0073】，【0077】，【0080】及び【0095】には，「発呼側装置と被呼側装置との間の暗号通信に使用される通信用暗号鍵の生成に用いられる乱数に限らず「シーケンス番号」を用いてもよいこと」が，④乙7(特表平4-505694号公報)の11頁右上欄5行～12行，11頁左下欄22行～12頁左上欄17行及び図4には，「暗号化のために用いられるキーストリームを発生するためにカウント213，214というシーケンス番号を用いていること」が記載されている。これらの文献は，シーケンス番号を使用して鍵を生成することによって効率的に鍵を共有することができることを示している。
    以上の引用刊行物1の記載及び技術常識を踏まえれば，当業者であれば，第5原則第2文中の「be used…for a given eNB key」の「eＮB鍵のために使用される」との記載がeＮB鍵の生成，共有，配送について主として述べている文脈中に存在しながら，「eＮB鍵の生成のために」使用される趣旨を含んでいないと解釈することはできず，むしろ，その趣旨を含むものと解釈するものである。
    したがって，本件審決がした本件和訳は，逐語的な直訳を示さなかった点では不適切であったものの，誤訳とはいえないから，本件和訳に基づいてした本件審決の引用発明の認定にも誤りはない。
  (イ)
    原告は，これに対し，引用刊行物1の後のバージョンである甲8及び甲9の1を踏まえると，第5原則の第2文中の「A given sequence number」にいう「sequence number」とは「COUＮT」を意味し，第2文は，ある所与のシーケンス番号(「COUＮT」)が，(暗号化及び完全性保護に用いられる際に，)ある所与のeＮB鍵を基にして得られたUP鍵(K )及びRRC鍵(K ，K )eＮB-UP-enc eＮB-RRC-enc eＮB-RRC-intのために用いられるのは一度でなければならないことを述べたものであり，本件和訳は誤訳である旨主張する。
    しかしながら，本願の優先権主張日前に発行された乙2(3GPP TS 33.102 version 7.1.0 Release 7)には，シーケンス番号には，部分的に時間を基にしたもの，時間を基にしていないもの，完全に時間を基にしたものが存在することが記載されており，上記記載によれば，「シーケンス番号」という用語は，「シーケンス番号」としての属性を有するこれらの様々なものを当該属性に即した上位概念として示す用語であることを理解することができる。
    そうすると，「シーケンス番号」は，規格として定められた特定のパラメータを指すことが明示されているのであればともかく，そうでない限りは，規格とされた文献あるいは規格とされていない文献における特定のパラメータを示すものということはできない。
    甲8及び甲9の1は，引用刊行物1の発行後にLTEに関する規格として発行された技術文書であるが，引用刊行物1には「sequence number(シーケンス番号)」が「COUＮT」である旨の記載はもちろん，「COUＮT」というパラメータの定義自体が存在しないから，引用刊行物1の発行時点では，「COUＮT」というパラメータやこのようなパラメータの利用方法が規格とされていなかったものといえるものであり，引用刊行物1に接した当業者が「sequence number(シーケンス番号)」が「COUＮT」を意味し，他のシーケンス番号ではあり得ないと考えることはない。また，仮に原告が主張するように発行時点より後に規格とされた技術文書の内容を取り込む解釈が許容されることになれば，甲8において「特定的でない参照」として参照されている乙3(3GPP TS 33.401 version 8.3.1 Release 8)の図6．2-2(別紙2参照)には，MMEにおいてK からK を生成するに当たって「ＮAS  UPASME eＮBLIＮK  COUＮT」という「シーケンス番号」を用いることが図示されているから，引用刊行物1にその旨が記載されていると認定することすら可能であることになる。
    したがって，原告の上記主張は，理由がない。
    イ 一致点の認定について
  (ア)
    前記ア(ア)のとおり，引用刊行物1の記載からみて，第5原則の第2文がeＮB鍵の生成，共有，配送について主として述べている文脈において「A given sequence number…be used for a given eNB keys…」(シーケンス番号は…eＮB鍵のために使用される…)と記載しているものであって，「eＮB鍵のために」使用される旨の記載がeＮB鍵の生成，共有，配送について主として述べている文脈中に存在しながら「eＮB鍵の生成のために」使用される趣旨を含んでいないと解釈することはできない。本件審決は，このことを踏まえて，本件和訳をしたものであり，本件和訳に誤りはなく，本件審決の引用発明の認定に誤りはない。
    したがって，本件審決が「シーケンス番号…から，前記セキュリティキーK＿eＮBを導出する」点を本願発明と引用発明の一致点と認定したことに誤りはない。
  (イ)
    原告は，これに対し，引用刊行物1記載の第5原則の第2文中の「A given sequence number」にいう「sequence number」とは，「COUＮT」を意味するものであり，「COUＮT」はHFＮ及びPDCPシーケンス番号から構成されるものであるから，「ＮAS＿U＿SEQ」とは異なるシーケンス番号である，第5原則は，「E-UTRAＮ」すなわち「UE」と「eＮB」間のネットワークのセキュリティについて述べたものであるのに対し，「ＮAS」は，「UE」と「MME」との間のプロトコルであり，本願発明と引用発明とは，「シーケンス番号」が用いられるプロトコルが異なるから，「シーケンス番号」の意味が異なることは，当業者にとって自明であるとして，引用発明における「シーケンス番号」には，本願発明の「ＮAS＿U＿SEQ」は含まれないから，本件審決の一致点の認定に誤りがある旨主張する。
    しかしながら，前記ア(イ)のとおり，引用刊行物1の「シーケンス番号」は，「シーケンス番号」としての属性を有する様々なものを当該属性に即した上位概念を示す用語であり，本願発明の「ＮAS＿U＿SEQ」が「シーケンス番号」としての属性を有する情報であれば，これが含まれないということはできない。本件審決は，相違点の判断において，「シーケンス番号」とその下位概念である「ＮAS＿U＿SEQ」とが区別されることを前提として説示したが，この区別は，「ＮAS＿U＿SEQ」がその上位概念である「シーケンス番号」としての属性を有することを前提としたものである。
    また，前記ア(イ)のとおり，引用刊行物1の発行時点では，「COUＮT」というパラメータやこのようなパラメータの利用方法が規格とされていなかったから，引用刊行物1に接した当業者が「sequence number(シーケンス番号)」が「COUＮT」を意味し，他のシーケンス番号ではあり得ないと考えることはない。
    さらに，本願発明の特許請求の範囲(請求項1)の「次世代パケットシステムEPSのモビリティ管理エンティティ(13)MMEにおいて，ユーザ装置(11)UEと前記UEにサービスするeＮodeB(12)との間のRRC／UPトラフィックを保護するためにセキュリティキーK＿eＮBを確立する方法」との記載によれば，本願発明は「UE」と「eＮB」間のセキュリティに係るものであるから，引用刊行物1が「UE」と「eＮB」間のセキュリティについて述べたものであることは，本願発明と引用発明とが異なるプロトコルについて述べたものであることの根拠にならない。
    したがって，原告の上記主張は理由がない。
    ウ 小括
      以上によれば，原告主張の取消事由1は理由がない。
      (2) 取消事由2(相違点の看過)に対し
    ア
      本件審決は，引用刊行物1の摘記箇所において，本願発明の「ＮASサービス要求を前記UEから受信するステップ」に対応する構成が明記されていないことを踏まえて，これを一致点と認定せずに，相違点と認定した上で，相違点の判断を示している。
      本件審決は，相違点の判断において，「UE」からのアップリンクに「シーケンス番号」を含ませることも，当業者には知られた技術であると判断している。「UE」からのアップリンクに「シーケンス番号」を含ませることは，「UE」から上位局(UEより「網側」の局)が受信するアップリンクに「シーケンス番号」を含ませることを意味するものであり，「UE」から様々な「アップリンク」が上位局に送信され，これを上位局が受信することを前提とするものである。
      したがって，「UE」からのアップリンクに「シーケンス番号」を含ませることも，当業者には知られた技術であるとの本件審決の上記判断には，「UE」からの「アップリンク」を上位局が受信する技術が当業者に知られた技術であるとの判断が前提に含まれている。
    イ
      また，引用刊行物1(甲1，乙1)には，「ＮASダイレクト・メッセージ」が「UE」から「(MME中の)ＮAS」へ転送する(transfer)こと(7．1)，「初期直接転送(Initial Direct Transfer)」という「ＮASメッセージ(NAS message)」が「RRC接続要求(RRC connection request)に結びつけられる (concatenated)こと(7．3)が記載され，さらに，RRCコネクション要求とＮASサービス要求とがUEからeＮBに送られ，その後にeＮBからMMEへ送られた後にS1インターフェース(eＮBとMMEとの間の通信)におけるコンテキストセットアップ手順が始まる様子(図19．2．2．3)(別紙1参照)が図示されている。
      これらによれば，「UE」から「RRCコネクション要求」とともに「eＮB」を経由して送られる「初期直接転送」という「ＮASメッセージ」ないし「ＮASサービス要求」を，MMEが受信するものと理解することができる。
      そうすると，引用刊行物1の上記記載内容に照らせば，「ＮASサービス要求をUEから受信するステップ」は，本願発明と引用発明との一致点であると整理することもできる。
    ウ
      以上によれば，本件審決の相違点の認定に誤りはなく，また，事実上，「ＮASサービス要求を前記UEから受信するステップ」に対応する構成を一致点と整理しても，本件審決の論旨の大枠が崩れることはなく，本件審決の結論にも影響しない。
      したがって，原告主張の取消事由2は理由がない。
      (3) 取消事由3(相違点の容易想到性の判断の誤り)に対し
    ア
      前記(1)ア(ア)のとおり，引用刊行物1には，第5原則第2文において，「eＮB鍵を得るためにシーケンス番号が使用される」構成が開示されている。
      そして，前記(1)ア(ア)のとおり，シーケンス番号を使用して鍵を生成することによって効率的に鍵を共有することができることは，セキュリティの分野における技術常識であり，また，引用刊行物2(甲2の1)に示されているように，UEからのアップリンクにシーケンス番号が含まれていることは広く知られている。
      そうすると，このようなアップリンクに含まれるシーケンス番号のうち，具体的に何を使用するかは，結局のところ，使用できるものの中から適宜選択すべきことにすぎない。
      しかるところ，前記(2)のとおり，引用刊行物1には「ＮASサービス要求をUEから受信するステップ」が事実上記載されているということができるところ，このUEからの「ＮASサービス要求」は，UEとeＮBとの暗号化等を用いた通信の前提となるRRCコンテキストがセットアップされる前にRRCコネクションリクエストとともに行われるから，ＮASサービス要求に含まれるシーケンス番号は，暗号化等を用いた通信を開始することが可能となる前の段階で追加のコストを要せず必然的にUEとMMEとの双方で利用可能となる。暗号化等に用いる鍵を生成するための情報は，暗号化等を用いた通信を開始する前の段階でUEとMMEの双方においてが利用可能である必要があるが，「ＮASサービス要求」に含まれるシーケンス番号は，追加のコストを要せずこの要件を満たすものなのであって，その意味では，これを利用することが望ましいものといえる。
      以上によれば，相違点は格別のものではなく，相違点に係る本願発明の構成は容易想到であるとした本件審決の判断に誤りはない。
    イ
      原告は，これに対し，本願明細書には，本願発明は，「K＿eＮB」の生成に「ＮAS＿U＿SEQ」を使用することにより，「MMEからUEへの明示的なダウンリンクＮASサービス受理メッセージまたはシーケンス番号が必要ではないこと，およびＮASセキュリティコンテキストの再生保護機能が，RRCおよびUPセキュリティコンテキストにおいて再利用されること」(段落【0011】)といった顕著な効果を奏することが開示されているが，本件審決が本願発明と引用発明との相違点は格別のものではないと判断するに際し，本願発明が引用発明と比べて顕著な効果を奏することを考慮していないから，上記判断は誤りである旨主張する。
      しかしながら，MMEからUEへの明示的なダウンリンクＮASサービス受理メッセージが必要でないことは，本願明細書記載の従来技術及び引用刊行物1に記載された技術において既に達成されていた効果であって(本願明細書の段落【0026】ないし【0028】，図1，引用刊行物1の「19．2．2．3」参照。)，本願発明に特有のものではない。
      また，「ユーザ装置(11)UEと前記UEにサービスするeＮodeB(12)との間のRRC／UPトラフィックを保護するため」の「セキュリティキーK＿eＮB」の「確立」のための「別個のシーケンス番号」の必要がなくなることは，シーケンス番号としてＮASメッセージに含まれるシーケンス番号(ＮASセキュリティコンテキストの再生保護機能)を用いたことによる予想どおりの効果にすぎず，格別なものでない。
      したがって，原告の上記主張は，その前提を欠くものであり，理由がない。
      (4) まとめ
        以上のとおり，原告主張の取消事由はいずれも理由がないから，本願発明は特許法29条2項の規定により特許を受けることができないとした本件審決の判断に誤りはない。
第4 当裁判所の判断
  1 取消事由1(引用発明及び一致点の認定の誤り)について
    (1) 本願明細書の記載事項について
      ア
        本願発明の特許請求の範囲(請求項1)の記載は，前記第2の2のとおりである。
      イ
        本願明細書(甲4)の「発明の詳細な説明」には，次のような記載がある(下記記載中に引用する図面について別紙本願明細書図面を参照)。
        (ア) 「【技術分野】
          技術分野
          本発明は，電気通信システムにおける方法および構成に関し，特に，UEによってトリガされたサービス要求のための，EPS(次世代パケットシステム)，すなわちE-UTRAＮ(次世代UMTS地上無線アクセスネットワーク)およびEPC(次世代パケットコアネットワーク)におけるセキュリティソリューションに関する。より具体的には，本発明は，EPS(次世代パケットシステム)用のMME(モビリティ管理エンティティ)およびUE(ユーザ装置)において，RRC／UPトラフィックを保護するためにセキュリティキーを確立する方法および構成に関する。」(段落【0001】)
        (イ) 「【背景技術】
          背景
          EPSアーキテクチャでは，加入者認証は，UEとMME(モビリティ管理エンティティ)との間で実行され，かつMMEは，例えば，モビリティ，UE識別情報，およびセキュリティパラメータを管理する。EPSにおけるセキュリティ手順を定義するための基礎は，セキュリティキーK＿ASMEであり，このキーは，MMEとUEとの間で共有され，かつUEの認証において確立される。ASME(アクセスセキュリティ管理エンティティ)と呼ばれる，EPSアーキテクチャの機能エンティティは，例えばMMEと同じ場所に配置してもよく，ASMEは，ホームネットワークに制限されたCK／IKキーから導出されたセキュリティキーK＿ASMEを受信および記憶する。ASMEは，セキュリティキーK＿ASMEから，ＮASシグナリング，すなわち次世代パケットコア(EPC)ネットワークのMMEとUEとの間の非アクセス層シグナリングを保護するために用いられるＮASセキュリティコンテキストを導出する。ＮASセキュリティコンテキストには，K＿ＮAS＿enc，K＿ＮAS＿intなど，ＮASシグナリングの暗号化および完全性保護用のパラメータ，ならびにＮAS＿U＿SEQおよびＮAS＿D＿SEQなど，アップリンクおよびダウンリンクシーケンス番号が含まれ，シーケンス番号は，暗号化および完全性保護手順への入力だけでなく，古いメッセージの再生を防ぐために用いられる。ASMEは，MMEにＮASセキュリティコンテキストを提供し，1つのＮASセキュリティコンテキストが，MMEに保持され，対応するＮASセキュリティコンテキストが，UEに保持され，再生保護，完全性保護および暗号化は，MMEおよびUEのＮASセキュリティコンテキストのシーケンス番号が，再使用されないことに基づいている。」(段落【0002】)
          「UEとサービスeＮodeB(すなわち，EPSアーキテクチャにおける無線基地局)との間のUP／RRCトラフィックを保護するためのセキュリティコンテキストもまた，前記セキュリティキーK＿ASMEに基づくのが好ましい。UP／RRCセキュリティコンテキストを確立する手順には，K＿eＮBと呼ばれるキーであって，これから，暗号化キーK＿eＮB＿UP＿encが，UP(ユーザ平面)すなわちEPCおよびE-UTRAＮ上で転送されるエンドユーザデータを保護するために導出されるキー，ならびにRRC(無線資源制御)を保護するための暗号化キーK＿eＮB＿RRC＿encおよび完全性保護キーK＿eＮB＿RRC＿intを導出することが含まれる。」(段落【0003】)
          「図1は，EPSアーキテクチャにおける，UEが開始したアイドルからアクティブへの状態遷移のための従来の例示的なシグナリングフローを示す。アイドルUEは，EPSのEPC(次世代パケットコア)だけに認識されており，UP／RRCセキュリティコンテキストは，eＮodeBとUEとの間には存在しない。アクティブ状態におけるUEは，EPCおよびEUTRAＮの両方において認識されており，UP／RRCセキュリティコンテキストが，UEとそのサービスeＮobeBとの間でUP／RRCトラフィックを保護するために確立された。」(段落【0004】)
          「図1は，UE11，eＮodeB12，MME13，サービスGW(ゲートウェイ)14，PDＮゲートウェイ15，およびHSS(ホーム加入者サーバ)16を示す。サービスゲートウェイ14は，EUTRAＮに向かってインタフェースを終端するEPCのノードであり，PDＮゲートウェイは，PDＮ(パケットデータネットワーク)に向かってインタフェースを終端するEPCのノードである。UEが複数のPDＮにアクセスする場合には，そのUEのために複数のPDＮゲートウェイがあってもよい。信号S1および信号S2では，ＮASサービス要求は，UEからMMEへ透過的に転送され，かつＮASサービス要求は，ＮAS＿U＿SEQに基づいて，完全性が保護される。オプションの信号S3では，UEは，MMEによって認証され，K＿ASMEは，HSS(ホーム加入者サーバ)に記憶された加入者データを用いて確立され，MMEは，S4で，初期コンテキストセットアップ要求をeＮodeBに送信する。信号S5およびS6では，eＮodeBは，UEとの無線ベアラを確立してアップリンクデータを転送し，信号S7で，初期コンテキストセットアップ完了メッセージをMMEへ返す。信号S8では，MMEは，更新ベアラ要求をサービスGWに送信し，サービスGWは，信号S9で応答する。」(段落【0005】)
          「従来のソリューションでは，RRC／UPセキュリティコンテキスト用の，UEおよびMMEによるK＿eＮBの導出は，例えば，MMEからUEに送信されたＮASサービス受理メッセージまたは他の明示的な情報に基づいている。しかしながら，図1における例示的な従来のEPSシグナリングフローに示されているように，MMEは，通常，EPSにおいて，UEからＮASサービス要求を受信しても，いかなるＮASサービス受理も送信しない。したがって，ＮASサービス受理メッセージにおける情報からK＿eＮBを導出することは不可能である。」(段落【0006】)
          「例示的な公知のソリューションによれば，K＿eＮBは，ＮASサービス受理メッセージにおいてMMEによって用いられるK＿ASMEおよびＮAS＿D＿SEQからMMEによって導出され，UEは，ＮASサービス受理メッセージからシーケンス番号ＮAS＿D＿SEQを検索し，かつMMEと同じK＿eＮB導出を実行することによって，同じK＿eＮBを導出する。MMEは，それがeＮodeBへのS1接続を設定する場合に，K＿eＮBをeＮodeBに転送する。しかしながら，この公知のソリューションの欠点は，明示的なＮASサービス受理メッセージがMMEからUEに対して定義されない場合には，図1における例示的な従来のEPSシグナリングフローにおけるように，UEが，MMEと同じK＿eＮBを導出することは不可能であることである。たとえUEが，現在のＮASダウンリンクシーケンス番号ＮAS＿D＿SEQを推定することが技術的に可能であっても，この推定は誤っている可能性がある。なぜなら，MMEは，損失してUEによって決して受信されなかったＮASメッセージを送信したかもしれないからである。かかる場合には，MMEは，そのＮAS＿D＿SEQを更新し，UEが，この更新に気づくこともなく，UEにおける誤ったＮAS＿D＿SEQにつながることになろう。」(段落【0007】)
          「別の例示的な公知のソリューションによれば，K＿eＮBの導出は，特にK＿eＮBの導出のために保持される別個のシーケンス番号に基づき，このシーケンス番号は，UEがそれをMMEに送信するかまたはMMEがそれをUEに送信することによって，ＮASサービス要求手順の間に明示的に同期される。しかしながら，このソリューションの欠点は，別個のシーケンス番号の特別な複雑さである。なぜなら，再生攻撃を防ぐために，別個のシーケンス番号をUEおよびMMEの両方において保持しなければならないからである。」(段落【0008】)
        (ウ) 「【発明が解決しようとする課題】
          概要
          本発明の目的は，上記で概説した課題に取り組むことであり，この目的および他の目的は，独立請求項による方法および構成ならびに従属請求項による実施形態によって達成される。」(段落【0009】)
        (エ) 「【課題を解決するための手段】
          本発明の基本的な考えは，K＿eＮBが，K＿ASMEから，およびUEからMMEへのＮASサービス要求メッセージのＮAS＿U＿SEQから導出され，それによって，eＮodeBにおけるUP／RRCセキュリティコンテキストの確立をトリガするということである。」(段落【0010】)
          「MMEからUEへの明示的なダウンリンクＮASサービス受理メッセージまたはシーケンス番号が必要ではないこと，およびＮASセキュリティコンテキストの再生保護機能が，RRCおよびUPセキュリティコンテキストにおいて再利用されることが，本発明の利点である。」(段落【0011】)
          「一態様によれば，本発明は，次世代パケットシステムEPSのモビリティ管理エンティティMMEにおいて，ユーザ装置UEとUEにサービスするeＮodeBとの間のRRC／UPトラフィックを保護するためにセキュリティキーK＿eＮBを確立する方法を提供する。この方法には，UEからＮASサービス要求を受信するステップであって，この要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップと，少なくとも前記受信されたＮAS＿U＿SEQから，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEからセキュリティキーK＿eＮBを導出するステップと，前記導出されたK＿eＮBを，前記UEにサービスするeＮodeBに転送するステップと，が含まれる。」(段落【0012】)
          「第2の態様によれば，本発明は，次世代パケットシステムEPS用のモビリティ管理エンティティMMEを提供する。MMEは，UEとUEにサービスするeＮodeBとの間のRRC／UPトラフィックを保護するために，セキュリティキーK＿eＮBを確立するように構成される。MMEには，UEからＮASサービス要求を受信するための手段であって，この要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示す手段と，少なくとも前記受信されたＮAS＿U＿SEQから，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEからK＿eＮBを導出するための手段と，ならびに，前記導出されたK＿eＮBを，前記UEにサービスするeＮodeBに送信するための手段と，が含まれる。」(段落【0013】)
          「第1および第2の態様は，さらに，方法および対応する手段を提供し，これらに従って，MMEが，擬似乱数関数PRFを用いてＮAS＿U＿SEQおよびK＿ASMEからK＿eＮBを導出可能になる。MMEは，さらに，受信された下位ビットから完全なＮASアップリンクシーケンス番号ＮAS＿U＿SEQを再構成し，UEから受信されたＮASサービス要求の完全性を検査してもよい。さらに，MMEは，受信されたＮAS＿U＿SEQの通知をUEに返してもよく，ＮAS＿U＿SEQは，K＿eＮBをeＮodeBに転送するセットアップメッセージに含まれていてもよい。それによって，UEは，MMEに送信されるＮAS＿U＿SEQを覚えている必要がない。」(段落【0014】)
        (オ) 「【発明を実施するための形態】
          詳細な説明
          以下の説明では，本発明の完全な理解を提供するために，特定のアーキテクチャおよびステップシーケンスなどの特定の詳細が記載される。しかしながら，本発明が，これらの特定の詳細から逸脱する可能性がある他の実施形態において実行し得ることは，当業者には明らかである。」(段落【0020】)
          「本発明の概念は，セキュリティキーK＿eＮBが，アクセスセキュリティ管理エンティティキーK＿ASMEから，およびUEからMMEに送信されるＮASサービス要求メッセージのアップリンクシーケンスカウンタＮAS＿U＿SEQから導出され，それによって，eＮodeBにおいてUP／RRCセキュリティコンテキストの確立をトリガするということである。」(段落【0022】)
          「UEがアイドルモードにある場合には，ＮASセキュリティコンテキストが，存在しかつ例えば，上記のK＿ＮAS＿enc，K＿ＮAS＿int，ＮAS＿U＿SEQ，およびＮAS＿D＿SEQを含み，ＮASメッセージは，完全性および場合により機密性を保護される。したがって，ＮASセキュリティコンテキストにはまた，UEのセキュリティ能力，特に暗号化および完全性アルゴリズムが含まれる。」(段落【0023】)
          「ＮASメッセージの保護は，ＮASセキュリティキーK＿ＮAS＿enc，K＿ＮAS＿int，ならびにメッセージの方向についてアップリンクおよびダウンリンクシーケンスカウンタＮAS＿U＿SEQまたはＮAS＿D＿SEQに基づいている。完全なシーケンスカウンタは，通常，ＮASメッセージと共に送信されず，下位ビットいくつかだけであり，完全なシーケンス番号は，上位ビットの局所推定および受信された下位ビットから，受信端で再構成される。」(段落【0024】)
          「図1における従来のシグナリング図のS1およびS2では，ＮASサービス要求は，アップリンクシーケンスカウンタＮAS＿U＿SEQを含むが，UEからMMEに転送され，ＮASサービス要求メッセージは，前記ＮAS＿U＿SEQに基づいて完全性が保護される。MMEは，メッセージの完全性を検査し，それが再生でない場合には，それを受理し，これによって，ＮAS＿U＿SEQが，新しく以前に用いられなかったことが保証される。」(段落【0026】)
          「その後，本発明によれば，MMEは，少なくとも，受信されたアップリンクシーケンスカウンタＮAS＿U＿SEQおよびK＿ASMEに基づき，従来のキー導出関数を用いて，K＿eＮBを導出するが，これは，図1に示す従来のシグナリング図には含まれない。したがって，シーケンスカウンタは，認証においてのみリセットしてもよい。MMEは，信号S4のメッセージ，初期コンテキストセットアップ要求(S1-AP)で，またはそこに相乗りして，導出されたK＿eＮBをeＮodeBに送信する。」(段落【0027】)
          「信号S5では，eＮodeBは，無線ベアラ確立およびセキュリティ構成メッセージ(セキュリティモードコマンド)をUEに送信する。図1におけるように，これらのメッセージは，2つの別個のメッセージとして，または1つのメッセージに組み合わせて送信してもよく，UEによるこれらのメッセージの受信は，暗黙のうちに，信号S1におけるUEのＮASサービス要求の確認になる。セキュリティモードコマンドは，例えば，保護がいつ開始すべきかおよびどのアルゴリズムを用いるべきかを決定する。」(段落【0028】)
          「本発明によれば，UEは，信号S5でメッセージを受信すると，以前に実行されていない場合には，少なくともＮAS＿U＿SEQおよびK＿ASMEに基づき，従来のキー導出関数を用いて，K＿eＮBを導出する。その後，eＮodeBおよびUEは，UP／RRCセキュリティコンテキストを確立するが，これは，図1における従来のシグナリング図には示されていない。」(段落【0029】)
        (カ) 「図2は，本発明の第1の実施形態を示すが，この場合には，UEは，信号S24におけるK＿eＮBの導出のために，信号S21における初期ＮASサービス要求メッセージのＮAS＿U＿SEQを保持する。MMEは，信号S21でUEからＮAS＿U＿SEQを受信するか，またはＮAS＿U＿SEQを示す下位ビットだけを受信し，ＮAS＿U＿SEQおよびK＿ASMEに基づいてS22においてK＿eＮBを導出する。MMEは，導出されたK＿eＮBを信号S23でeＮodeBに転送する。」(段落【0032】)
          「その後，図2には示していないが，eＮodeBおよびUEは，K＿eＮBを用いてUP／RRCセキュリティコンテキストを確立するが，UP／RRCセキュリティコンテキストには，UPトラフィックを保護するための暗号化キーK＿eＮB＿UP＿enc，ならびにRRCトラフィックの保護のための暗号化キーおよび完全性保護キー，K＿eＮB＿RRC＿encおよびK＿eＮB＿RRC＿intがそれぞれ含まれ，それによって，信号S25において安全なUP／RRCトラフィックを可能にする。」(段落【0033】)
          「K＿eＮBの導出は，従来のキー導出関数によって，例えば擬似乱数関数K＿eＮB＝PRF(K＿ASME，ＮAS＿U＿SEQ，．．．)によって，実行される。」(段落【0034】)
        (キ) 「図3は，本発明による方法を示す流れ図であり，ステップ31において，UE11は，初期ＮASサービス要求メッセージをMME13に送信するが，このメッセージは，通常，カウンタの下位ビットだけを送信することによって，ＮASアップリンクシーケンスカウンタＮAS＿U＿SEQを示す。ステップ32において，MMEは，UEからＮASサービス要求メッセージを受信し，ＮAS＿U＿SEQを取得し，受信された下位ビットから完全なシーケンスを再構成する。ステップ33において，MMEは，適切なキー導出関数，例えば擬似乱数関数を用いて，少なくとも受信したＮAS＿U＿SEQ，およびASME(アクセスセキュリティモビリティエンティティ)からのK＿ASMEから，セキュリティキーK＿eＮBを導出する。」(段落【0036】)
          「その後，MMEは，ステップ34において，UEと共有される完全なUP／RRCセキュリティコンテキストを確立するためにeＮodeBによって用いられるように，導出されたK＿eＮBをeＮodeB12に転送する。ステップ35において，前記UEは，少なくとも記憶されたK＿ASMEから，およびステップ31においてUEからMMEに送信された初期ＮASサービス要求メッセージのＮAS＿U＿SEQから，同じK＿eＮBを導出し，導出されたK＿eＮBからUP／RRCセキュリティコンテキストを確立する。」(段落【0037】)
          「本発明の第1の実施形態では，UEは，初期ＮASサービス要求メッセージでMMEに送信されたＮAS＿U＿SEQを記憶し，記憶されたシーケンス番号を用いてK＿eＮBを導出する。」(段落【0038】)
        (ク) 「図6aは，本発明に従って，EPS用のMME13(モビリティ管理エンティティ)を示すが，このMME13は，UEとサービスeＮodeBとの間のUP／RRCトラフィックを保護するためのセキュリティコンテキスト用のセキュリティキーK＿eＮBを確立するようにさらに構成される。MMEには，図示していないが，EPSにおけるノードと，例えばS1-MMEインタフェースを介してeＮodeBsと通信するための従来の通信手段が設けられる。さらに，図1のMMEでは，ASME(アクセスセキュリティ管理エンティティ)61が，破線によって示されている。なぜなら，EPSのこの機能エンティティは，MMEと同じ場所に配置してもよいからである。」(段落【0043】)
          「セキュリティキーK＿eＮBを確立するための，図6aに示すMME13の手段には，(UEのサービスeＮodeBを介した)UEからのＮAS＿U＿SEQを含むＮASサービス要求メッセージを受信するために受信手段62と，従来のキー導出関数を用い，少なくとも受信されたＮAS＿U＿SEQおよび記憶されたK＿ASMEに基づいて，セキュリティキーK＿eＮBを導出するためのキー導出手段63と，導出されたK＿eＮBを，UEにサービスするeＮodeBに送信するための送信手段64と，が含まれる。」(段落【0044】)
          「図6bは，本発明によるUE11(ユーザエンティティ)を示すが，UEは，EPS用に構成され，さらに，UEのサービスeＮodeBと交換されるUP／RRCトラフィックを保護するためのセキュリティコンテキスト用のセキュリティキーK＿eＮBを確立するように構成される。UEには，そのサービスeＮodeBへのLTE-Uuインタフェースを介してEPSにおけるノードと通信するための従来の通信手段(図示せず)が設けられる。」(段落【0045】)
          「セキュリティキーK＿eＮBを確立するための，図6bに示すUE11の手段には，サービスeＮodeBを介して，ＮASサービス要求メッセージをMMEに送信するための送信手段66であって，この要求が，アップリンクシーケンス番号ＮAS＿U＿SEQを示す手段が含まれ，セキュリティキーK＿eＮBを確立するための手段には，従来のキー導出関数を用い，少なくともＮAS＿U＿SEQおよび記憶されたK＿ASMEに基づいて，セキュリティキーK＿eＮBを導出するためのキー導出手段67が含まれる。」(段落【0046】)
      ウ
        前記ア及びイによれば，本願明細書には，本願発明に関し，以下の点が開示されていることが認められる。
        (ア)
          EPS(次世代パケットシステム)においてUEが開始したアイドルからアクティブへの状態遷移のための従来の例示的なシグナリングフロー(別紙本願明細書図面の図1参照)においては，MMEとUEとの間の非アクセス層シグナリングを保護するためにＮASセキュリティコンテキストが用いられ，UEとサービスeＮodeBとの間のUP／RRCトラフィックを保護するためにUP／RRCセキュリティコンテキストが用いられる(段落【0002】ないし【0004】)。UP／RRCセキュリティコンテキストを確立する手順には，K＿eＮBと呼ばれるキーが導出され，K＿eＮBから，エンドユーザデータを保護するための暗号化キーK＿eＮB＿UP＿enc，RRC(無線資源制御)を保護するための暗号化キーK＿eＮB＿RRC＿enc及び完全性保護キーK＿eＮB＿RRC＿intを導出することが含まれる(段落【0003】)。
          従来のソリューションでは，RRC／UPセキュリティコンテキスト用のUE及びMMEによるK＿eＮBの導出は，例えば，MMEからUEに送信されたＮASサービス受理メッセージ又は他の明示的な情報に基づいているが，従来の例示的なシグナリングフローにおいては，MMEは，通常，EPSにおいて，UEからＮASサービス要求を受信しても，いかなるＮASサービス受理も送信しないため，ＮASサービス受理メッセージにおける情報からK＿eＮBを導出することは不可能であった(段落【0006】)。また，別の例示的な公知のソリューションによれば，K＿eＮBの導出は，K＿eＮBの導出のために保持される別個のシーケンス番号を，UEがMMEに送信するか，または，MMEがUEに送信することによって行われるが，別個のシーケンス番号をUE及びMMEの両方において保持しなければならないため，複雑であるという欠点があった(段落【0008】)。
        (イ)
          本願発明のMMEにおける方法は，従来のRRC／UPセキュリティコンテキスト用のUE及びMMEによるK＿eＮBの導出における上記課題を解決することを目的とし，K＿eＮBが，アクセスセキュリティ管理エンティティキーK＿ASMEから，及びUEからMMEに送信されるＮASサービス要求メッセージのアップリンクシーケンス番号ＮAS＿U＿SEQから導出され，それによって，eＮodeBにおいてUP／RRCセキュリティコンテキストの確立をトリガするようにするため(段落【0022】)，ＮASサービス要求を前記UEから受信するステップ(32)であって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップと，少なくとも前記受信されたＮAS＿U＿SEQから，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ(33)と，前記導出されたK＿eＮBを，前記UEにサービスする前記eＮodeB(12)に転送するステップ(34)と，を含む構成を採用した。
        (ウ)
          本願発明は，MMEからUEへの明示的なダウンリンクＮASサービス受理メッセージ又はK＿eＮBの導出のために保持される別個のシーケンス番号を必要とせず，また，ＮASセキュリティコンテキストの再生保護機能が，RRC及びUPセキュリティコンテキストにおいて再利用されるという利点を有する(段落【0011】)。
    (2) 引用刊行物1の記載事項について
      引用刊行物1(甲1，乙1)には，次のような記載がある(「図面」については別紙1を参照)。
      ア
        「EUTRAＮのアーキテクチャを，以下の図4に示す。
        4．1  機能の分割
        eＮBは，次の機能を実施する：
        -  無線機能管理のための機能：無線ベアラ制御，無線アドミッション制御，接続モビリティ管理，アップリンクと，ダウンリンクの双方における，UEのための資源の動的配置(スケジューリング)；
        -  IPヘッダの圧縮，及び，ユーザ・データ・ストリームの暗号化；
        -  UE接続時の，MMEの選択；
        注：  UE接続時，はじめにMMEは，含まれている，即ち，実質的には，MMEは選択されていると，仮定する。
        -  サービス・ゲートウェイへのユーザ・プレーン・データのルーティング；
        注：  どのノードがユーザ・プレーン・トンネルを実際に設立するかは，次の検討である。
        注：  ユーザ・プレーン・トンネルの確立が，RRC起動と共に起こるかどうかは，次の検討である。
        -  (MMEからのものである)ページング・メッセージのスケジューリングと送信；
        -  (MME，或いは，O＆Mからのものである)ブロードキャスト情報のスケジューリングと送信；
        -  モビリティ，及び，スケジューリングのための測定と，計測報告の設定．
        MMEは，次の機能を実施する：
        -  eＮBへのページング・メッセージの分配；
        -  セキュリティ制御；
        -  アイドル状態モビリティ制御；
        -  SAEベアラ制御；
        -  ＮAS信号伝達の暗号化と完全性保護．
        サービス・ゲートウェイは次の機能を実施する：
        -  ページング理由のための，U-プレーン・パケットの終端(次の検討である)；
        -  UEモビリティのサポートのためのU-プレーンの切替．」(甲1抄訳)
        「4．3．2  制御プレーン
        下の図(判決注・図4．3．2)は，制御プレーンのためのプロトコル・スタックを示している，それは，
        -  (ネットワーク側のeＮBで終端される)PDCPサブレイヤは，ユーザプレーンと同様のセキュリティ機能を実行するが，ヘッダの圧縮は実行しない；
        -  (ネットワーク側のeＮBで終端される)RLCおよびMACサブレイヤは，ユーザプレーンと同様の機能を実行する；
        -  (ネットワーク側のeＮBで終端される)RRCは，従属節7に一覧されている機能を実行する，たとえば：
        -  ブロードキャスト；
        -  ページング；
        -  RRC接続管理；
        -  RB制御；
        -  モビリティ機能；
        -  UE測定報告および制御；
        -  (ネットワーク側のMMEで終端されている)ＮAS制御プロトコルは，とりわけ次を実行する。
        -  SAEベアラ管理；
        -  認証；
        -  LTE＿IDLE  モビリティ・ハンドリング；
        -  LTE＿IDLEでのページングの開始；
        -  セキュリティ制御
        注：ＮAS制御プロトコルは，このTSの範囲で取り扱われず，情報としてのみ言及される。」(乙1抄訳)
      イ
        「7  RRC   この従属節は，RRCサブレイヤによって提供されるサービスと機能の概観を提供する。
        7．1  サービスと機能
        RRCサブレイヤの主なサービスと機能は，次を含む：
        -非アクセス層(ＮAS)に関連するシステム情報のブロードキャスト；
        -  アクセス層(AS)に関連するシステム情報のブロードキャスト；
        -  ページング；
        -  以下を含む，UEとE-UTRAＮ間のRRC接続の確立，維持，及び，解除；
        -  UEとE-UTRAＮ間の一時的な識別子の割当；
        -  RRC接続のための信号無線ベアラの設定：
        -  低品位SRBと高品位SRB -  以下を含むセキュリティ機能：
        -  RRCメッセージのための完全性保護
        -  ポイントツーポイント無線ベアラの確立，維持，及び，解除；
        -  以下を含むモビリティ機能
        -  セル間，及び，RAT間モビリティのためのUE測定報告，及び，報告の制御；
        -  セル間ハンドオーバ
        -  UEセル選択と再選択，及び，セルの選択と再選択の制御；
        -  eＮB間のコンテキスト転送
        -  MBMSサービスのための通知(次の検討である)；
        -  MBMSサービスのための無線ベアラの確立，配置，維持，及び，解除(次の検討である)；
        -  QoS管理機能；
        -  UE測定報告，及び，報告の制御；
        -  MBMS制御(次の検討である)；
        -  ＮASダイレクト・メッセージのUEからＮASへ／ＮASからUEへの転送」
        「7．3  ＮASメッセージの転送
        E-UTRAＮ内で，ＮASメッセージはRRCメッセージに結びつけられるか，結びつけられることなく，RRCに入れられる。
        初期直接転送は，もし転送ブロックサイズが許せば，RRC接続要求に結びつけられる(次の検討である)。他のＮASメッセージは，おそらく，(同期したＮAS／RRC手続のための)RRCメッセージ，に結びつけられる。
        注：ＮASによって実行された完全性保護と暗号化に加えて，ＮASメッセージは，RRCによって完全性が保護され，PDCPによって暗号化されている。」
        (以上，乙1抄訳)
      ウ (原文)
        「14 Security 14.1 Overview and Principles The following principles apply to E-UTRAN security:」
        「- The eNB keys are cryptographically separated from the EPC keys used for NAS protection (making it impossible to use the eNB key to figure out an EPC key).」(第1原則)
        「- The keys are derived in the EPC/UE from key material that was generated by a NAS (EPC/UE) level AKA procedure.」(第2原則)
        「- The eNB keys are sent from the EPC to the eNB when the UE is entering LTE_ACTIVE state (i.e. during RRCconnection or S1 context setup).」(第3原則)
        「- Key material for the eNB keys is sent between the eNBs during LTE_ACTIVE intra-E-UTRAN mobility.」(第4原則)
        「- A sequence number is used as input to the ciphering and integrity protection. A given sequence number must only be used once for a given eNB key (except for identical re-transmission). The same sequence number can be used for both ciphering and integrity protection.」(第5原則)
        「- A hyper frame number (HFN) (i.e. an overflow counter mechanism) is used in the eNB and UE in order to limit the actual number of sequence number bits that is needed to be sent over the radio.
        The HFN needs to be synchronized between the UE and eNB.」(第6原則)
        「As a result of an AKA run， the EPC and the UE share a base-key named K_ASME. From K_ASME， the NAS， (and indirectly) K_eNB keys are derived. The K_ASME never leaves the EPC， but the K_eNB key is transported to the eNB from the EPC when the UE transitions to LTE_ACTIVE. From the K_eNB， the eNB and UE can derive the UP and RRC keys. When the UE goes into LTE_IDLE or LTE_DETACHED， the K_eNB， UP and RRC keys are deleted from the eNB. The key hierarchy is depicted on Figure 14.1-1 below:」(概説)
        「14  セキュリティ
        14．1  概説及び原則
        次の原則は，E-UTRAＮのセキュリティに適用される：
        -  (EPC鍵を見つけ出すためにeＮB鍵を用いることが不可能なように)eＮB鍵は，暗号によって，ＮAS保護のために用いられるEPC鍵から分離される．」(第1原則)
        「-  その鍵は，EPC／UEにおいて，ＮAS(EPC／UE)レベルAKA手続によって生成された，鍵素材から得られる。」(第2原則)
        「-  eＮB鍵は，UEが，LTE＿ACTIVE状態に入ると(即ち，RRC接続，或いは，S1コンテキスト設定の間)，EPCから，eＮBに送られる。」(第3原則)
        「-  eＮB鍵のための鍵素材は，LTE＿ACTIVE  イントラ-E-UTRAＮモビリティの間に，eＮBの間に送られる。」(第4原則)
        「-  シーケンス番号は，暗号化，及び，完全性保護のための入力として用いられる。所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。同一のシーケンス番号が，暗号化と，完全性保護の両方に用いることができる。」(第5原則)
        「-  ハイパー・フレーム番号(HFＮ)(即ち，桁あふれ計数機構)は，無線上に送られるために必要な連続番号ビットの実数を制限するためにeＮBとUEの中で使用される。UEとeＮBの間でHFＮを同期する必要がある。」(第6原則)
        「AKA(判決注:認証及び鍵共有のためのプロトコル)実行の結果として，EPCとUEは，K＿ASMEという名の基本鍵を共有する。K＿ASMEから，ＮAS(そして，間接的に)，K＿eＮBが得られる。K＿ASMEは，決して，EPCから離れない。しかしながら，K＿eＮB鍵は，UEが，LTE＿ACTIVEに移行すると，EPCからeＮBに運ばれる。K＿eＮBから，eＮB，及び，UEは，UP，及び，RRC鍵を得ることができる。UEが，LTE＿IDLE，或いは，LTE＿DETACHEDの状態になると，K＿eＮB，UP，及び，RRC鍵は，eＮBから消去される。鍵階層は，下の図14．1-1に描かれている。」(概説)
        (以上，甲1抄訳)
    (3) 引用発明の認定の誤りの有無について
      原告は，本件審決が，本件審決が引用刊行物1の「A given sequence number must only be used once for a given eNB key」(第5原則第2文)との記載について「得られたシーケンス番号は，eＮB鍵を得るために使用されるのは，一度のみでなければならない」と和訳(本件和訳)した上で，上記記載箇所から「“eＮB鍵を得るために，シーケンス番号が使用される”ことが読み取れる。」と認定したが，本件和訳は誤訳であり，引用刊行物1には，他に「K＿eＮB」を導出する手法についての開示はないから，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示はないとして，本件審決が認定した引用発明のうち，「前記K＿eＮBを得るために，シーケンス番号が使用され」との部分は誤りである旨主張するので，以下において判断する。
      ア
        まず，引用刊行物1記載の第5原則第2文の「 A given sequence number must only be used once for a given eNB key (except for identical re-transmission).」は，その文理からみて，「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。」(前記(2)ウ)と和訳するのが自然である。
        そこで，第5原則第2文の「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。」にいう「eＮB鍵のために使用される」との意義について検討する。
      イ
        前記(2)によれば，引用刊行物1の「14．1  概説及び原則」には，第1原則としてeＮB鍵(K＿eＮB)はEPC鍵から分離されること，第2原則としてeＮB鍵はEPC／UEにおいてＮAS(EPC／UE)レベルAKA手続によって生成された鍵素材から得られること，第3原則としてUEがLTE＿ACTIVE状態に入ると，eＮB鍵はEPCからeＮBに送られること，第4原則としてeＮB鍵のための鍵素材はeＮB間で送られること，第6原則としてシーケンス番号を構成するハイパー・フレーム番号(HFＮ)についての記載があり，また，これらの「原則」に引き続き記載されている「概説」には，EPC及びUEが共有するK＿ASMEという名称の基本鍵からK＿eＮBが得られることや，eＮB及びUEにおいてK＿eＮBからUP及びRRC鍵を得られることが記載されている。
        このように「14．1  概説及び原則」には，第5原則の前後の文脈において，eＮB鍵(K＿eＮB)の「生成」及び「共有」(第2原則，概説)，「転送」(第3原則，概説)に関する記載がある。
        そして，第5原則には，eＮB鍵(K＿eＮB)と「シーケンス番号」との関係に関し，「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。」(第2文)との記載がある。
        一方で，第5原則には，「シーケンス番号」に関し，「シーケンス番号」が暗号化及び完全性保護のための入力として用いられること(第1文)，同一の「シーケンス番号」が暗号化と完全性保護の両方に用いることができること(第3文)についての記載があるが，「14．1  概説及び原則」には，第5原則第2文にいう「所与のあるシーケンス番号」が「eＮB鍵のために使用される」ことについて，その使用の具体的な態様を明示した記載はない。
      ウ
        被告は，この点に関し，シーケンス番号を使用して鍵を生成することによって効率的に鍵を共有することができることは，本願の優先権主張日当時，セキュリティの分野における技術常識であったことを踏まえると，シーケンス番号が「eＮB鍵のために使用される」とは，シーケンス番号が「eＮB鍵の生成のため」に使用されることを意味する旨主張するので，以下において，本願の優先権主張日当時におけるシーケンス番号に関する技術常識について検討する。
        (ア) 乙6の記載事項
          a
            乙6には，図1，図5及び図6とともに，以下の記載がある(上記各図面については別紙3を参照)。
            (a) 「【発明の属する技術分野】本発明は，通信の安全性を高めるために，暗号を用いて通信する暗号通信装置に関し，特に，暗号通信に先立って行われる暗号鍵伝送時の手間を簡略化できる暗号通信装置に関するものである。」(段落【0001】)
            (b) 「一方，本実施形態に係る暗号鍵生成部52は，暗号通信に先立って，後述する手順で通信相手の暗号通信装置3bと通信してネゴシエーションする。これにより，暗号鍵生成部52は，送信した暗号化乱数を，上記送信暗号化乱数領域42へ格納すると共に，受信した暗号化乱数を，受信暗号化乱数領域43へ格納する。さらに，暗号鍵生成部52は，両暗号化乱数に基づき，暗号通信時に使用される通信用暗号化鍵および通信用復号化鍵を生成して暗号処理部51へ通知できる。」(段落【0068】)
              「両暗号通信装置3a・3bが通信可能になると，発呼側の暗号通信装置3aは，図5に示すステップS1aにて，乱数A1を生成し，S2aにて，通信相手の暗号通信装置3bへ当該乱数A1を送出する。なお，以下では，発呼側の暗号通信装置3aが実行するステップには，例えば，S1aのように，符号の末尾にaを付して参照し，被呼側の暗号通信装置3bが実行するステップには，S1bのように，符号の末尾にbを付して参照する。」(段落【0072】)
              「一方，被呼側の暗号通信装置3bは，S1bにて，暗号通信装置3aから乱数A1を受け取ると，S2bにおいて，予め共有された共有鍵Oを用いて，当該乱数A1を暗号化する。これにより，暗号化乱数A2が生成される。さらに，暗号通信装置3bは，S3bにおいて，発呼側の暗号通信装置3aへ，生成した暗号化乱数A2を送り返す。」(段落【0073】)
              「さらに，発呼側と被呼側とを入れ換えて，上記S1a～S5aおよびS1b～S3bと同様のステップが行われる(S11b～S15bおよびS11a～S13a)。これらのステップでは，両暗号通信装置3a・3bは，被呼側の暗号通信装置3bが生成した乱数B1に基づいて，暗号化乱数B2・B3をそれぞれ生成する。これにより，被呼側の暗号通信装置3bは，発呼側の暗号通信装置3aを認証できる。」(段落【0077】)
              「両暗号通信装置3a・3bが通信相手による認証に成功すると，図6に示すように，上記両暗号化乱数A2・B2に基づいて，暗号通信に使用される通信用暗号鍵が生成される。すなわち，発呼側の暗号通信装置3aは，S21aにおいて，自ら(発呼側)が生成した暗号化乱数B2を共有鍵Oで暗号化して，暗号化データB4を生成する。また，S22aにおいて，受け取った暗号化乱数A2を共有鍵Oで暗号化して，暗号化データA5を生成する。」(段落【0080】)
            (c) 「また，本実施形態では，図5のステップS1a・S2a，および，S11b・S12bに示すように，両暗号通信装置3a・3bが乱数を生成して送出する場合について説明したが，これに限るものではない。例えば，日付や時刻，あるいは，シーケンス番号などを用いてもよい。両暗号通信装置3a・3bが通信毎に異なるデータを送出すれば，本実施形態と同様の効果が得られる。」(段落【0095】)
          b
            前記aの記載事項によれば，乙6には，暗号通信に使用される通信用暗号鍵の生成に，「乱数」や「シーケンス番号」が用いられることが開示されているものと認められる。
        (イ) 乙7の記載事項
          a
            乙7には，第4図とともに，以下の記載がある(第4図については別紙4を参照)。
            (a) 「発明の分野
              本発明は，ディジタル領域式通信システムに関し，特にそのようなシステム内のデータ通信の暗号化用の方法および装置に関する。」(5頁左下欄4行～7行)
            (b) 「本発明の特定な実施例の特定な説明をこれから行なう。上述の通り，かつ以下に使用される通り，「キーストリーム」という語は，未確認アクセス，例えばRFチャネルの影響を受けやすい媒体にある記憶を伝送する前に，ディジタル符号式メツセージまたはデータ信号を暗号化するのに用いられた2進ビットまたはビットのブロックの擬似ランダム・シーケンスを意味する。」(11頁右上欄5行～12行)
            (c)
              「第4図を参照すると，従来技術の日毎定時刻駆動による暗号化システムの略ブロック図を見ることができる。第4図の上半分は，送信機部分を表わし，下半分はそのような暗号化システムの受信機部分を表わす。送信機部分では，タイム・クロックまたはブロック・カウンタ201はカウント213，例えばタイム・クロックまたはブロック・カウンタ201の入力に加えられる増分215に応じて，32-ビットの出力を発生させる。カウント213は，結合式論理または混合工程202に第1入力として供給される。例えば，2進記法の値968173であるシークレット・キーは，第2入力211として，結合式論理または混合工程202の第2入力として供給される。カウント213に対して新しい値が生じるごとに，結合式論理または混合工程202は，シークレット・キー211をカウント213と結合させたり混合して，直列または並列出力209で複数の擬似ランダム・キーストリーム・ビットを発生させる。キーストリーム出力209は，同時に，モジュロ-2加算器203に入力として供給される。暗号化すべきデータは，モジュロ-2加算器203に第2入力207を形成する。各キーストリーム・ビットは，モジュロ-2加算機203によって特定のデータ・ビットに加えられるモジュロ-2であり，暗号式データは媒体を通して伝送する出力218に供給される。
              受信機部分では，タイム・クロックまたはクロック・カウンタ204は，タイム・クロックまたはブロック・カウンタ201と構造が同じであり，増分215と同じ増分216を供給され，結合式論理または混合工程202と構造が同じである結合式論理または混合工程205にカウント214を供給する。結合式論理または混合工程205は，カウント214を同一なシークレット・キー，すなわち入力212に供給される2進記法の968173と結合させたり混合したりするが，それによって出力210にキーストリームを作り，この出力は出力209で作られたキーストリームと同じである。キーストリーム出力210は，モジュロ-2加算器206によって伝送媒体で受信された暗号式データに少しずつ加えられるモジュロ-2である。モジュロ-2加算およびモジュロ-2減算は同じ操作であり，受信機における同一キー・ストリームのモジュロ-2加算は送信機におけるキーストリームの前の加算を打ち消して，出力208で原データの回復をもたらす。しかし，暗号式データのそのような打消しおよび正しい解読は，タイム・クロックまたはブロック・カウンタ2f01，204が相互に完全に同期機構217は，この目的で供給されなければならない。」(11頁左下欄22行～12頁左上欄17行)
          b
            前記aの記載事項によれば，乙7には，暗号鍵である「キーストリーム」の生成に，シーケンス番号である「カウント」が用いられることが開示されているものと認められる。
        (ウ) 引用刊行物2の記載事項
          引用刊行物2(甲2の1)のFIG．3A(別紙5)によれば，引用刊行物2には，「Full  Sequence  Ｎumber」(フルシーケンス番号)が「Keystream」(キーストリーム)の生成に用いられることが開示されているものと認められる。
        (エ) 検討
          以上によれば，本願の優先権主張日当時，暗号鍵の生成に，シーケンス番号が用いられることは，当業者の技術常識であったものと認められる。
      エ
        前記イのとおり，引用刊行物1の「14．1  概説及び原則」には，第5原則第2文にいう「所与のあるシーケンス番号」が「eＮB鍵のために使用される」ことについて，その使用の具体的な態様を明示した記載はない。
        しかるところ，「14．1  概説及び原則」には，第5原則の前後の文脈において，eＮB鍵(K＿eＮB)の「生成」及び「共有」(第2原則，概説)，「転送」(第3原則，概説)に関する記載があり(前記イ)，第5原則は，そのような一連の文脈の中で理解されるべきものであること，本願の優先権主張日当時，暗号鍵の生成に，シーケンス番号が用いられることは，当業者の技術常識であったこと(前記ウ(エ))に鑑みると，引用刊行物1に接した当業者は，第5原則第2文の「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。」にいう「eＮB鍵のために使用される」とは，暗号鍵である「eＮB鍵の生成のために」使用されることを意味し，「第2文」は，「所与のあるeＮB鍵」の生成のために一度使用された「所与のあるシーケンス番号」は，当該「所与のあるeＮB鍵」の生成のために再度使用してはならないことを記載したものと理解するものと認められる。
        そうすると，「シーケンス番号」が，「eＮB鍵の生成のために使用される」とは，本件審決が認定した引用発明の「K＿eＮBを得るために，シーケンス番号が使用され」ることと技術的に同じ意味であるといえるから，本件審決が認定した引用発明のうち，「前記K＿eＮBを得るために，シーケンス番号が使用され」との部分が誤りであるとはいえないというべきである。
      オ 原告は，これに対し，①引用刊行物1(3GPP TS 36.300 version 8.1.0
        Release 8)の後のバージョンの甲8(3GPP TS 36.300 version 8.8.0 Release 8)に「A sequence number (COUNT) is used as input to the ciphering and integrity protection.」との記載があることからすると，第5原則第2文中の「A given sequence number」にいう「sequence number」とは「COUＮT」を意味すること，②引用刊行物1の後のバージョンの甲9の1(3GPP TS 36.323 version 1.0.0 Release 8)には，シーケンス番号の一種である「COUＮT」が，暗号化及び完全性保護のパラメータとして，K ，K 及びK のようなeＮB鍵の下位の鍵と共に用RRCenc UPenc RRCintいられることが示されていることからすると，第5原則は，第1文において，シーケンス番号が暗号化及び完全性保護の入力として用いられること，第2文において，ある所与のシーケンス番号が，(暗号化及び完全性保護に用いられる際に，)ある所与のeＮB鍵を基にして得られたUP鍵(KeＮB-UP-)及びRRC鍵(K ，K )のために用いられenc eＮB-RRC-enc eＮB-RRC-intるのは一度でなければならないこと，第3文において，所与のeＮB鍵(正確には，その下位のUP鍵及びRRC鍵)が暗号化及び完全性保護の手続に用いられることを述べたものであることからすると，第5原則第2文は，暗号化及び完全性保護の手続について述べたものであって，シーケンス番号がeＮB鍵の生成のために用いられることを述べたものではない旨主張する。
        しかしながら，原告の主張は，以下のとおり理由がない。
        (ア) 上記①の点について
          a
            甲8には，「-  シーケンス番号(COUＮT)は，暗号化，及び，完全性保護のための入力として用いられる。所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，同一方向における同一の無線ベアラにおいては(同一の再送のためを除いて)一度のみでなければならない。同一のシーケンス番号が，暗号化と，完全性保護の両方に用いることができる。」(原文73頁下から9行～下から7行の訳文)との記載がある。
            甲8の上記記載と引用刊行物1の「14．1  概説及び原則」の第5原則第2文とを対比すると，上記記載のうち，「シーケンス番号(COUＮT)は，暗号化，及び，完全性保護のための入力として用いられる。」との記載箇所は，第5原則第1文の「シーケンス番号」を「シーケンス番号(COUＮT)」としたほかは，第1文と同内容であること，「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，同一方向における同一の無線ベアラにおいては(同一の再送のためを除いて)一度のみでなければならない。」との記載箇所は，第5原則第2文に「同一方向における同一の無線ベアラにおいては」の文言を付け加えたほかは，第2文と同内容であること，「同一のシーケンス番号が，暗号化と，完全性保護の両方に用いることができる。」との記載箇所は第3文と同内容であることが認められる。
          b 上記認定事実によれば，引用刊行物1(3GPP TS 36.300 version 8.1.0 Release 8(2007-06))の公開時(2007年(平成19年)6月)には，第5原則第1文の「暗号化，及び，完全性保護のための入力」として「シーケンス番号」を用いること自体は決定されていたが，具体的にどのようなシーケンス番号を用いるのかについては決定されておらず，その後検討が進められた結果，引用刊行物1と同じ規格(「3GPP TS 36.300」)の後のバージョンである甲8(3GPP TS 36.300
            version 8.8.0 Release 8(2009-03))の公開時(2009年(平成21年)3月)までに，第5原則第1文の「シーケンス番号」として「COUＮT」を規格として採用することが決定されたものと推認される。このように引用刊行物1の公開時には，第5原則第1文の「シーケンス番号」として具体的にどのようなシーケンス番号を用いるのかについては決定されていなかったことに照らすと，同様に，第5原則第2文の「所与のあるシーケンス番号」にいう「シーケンス番号」についても，具体的にどのようなシーケンス番号を用いるのかについては決定されていなかったと解するのが自然であるから，これが「COUＮT」として特定されていた旨の原告の主張は採用することができない。
        (イ) 上記②の点について
          a
            甲9の1には，次のような記載がある。
            (a) 「5．3  暗号化及び復号化
              暗号化機能はPDCPで実行される。暗号化されるデータユニットは，ヘッダ圧縮が構成される場合はその後のPDCP  PDUのデータ部分(Uプレーンデータに関連するPDCPエンティティにのみ適用)(項目6．3．2を参照)及び，可能な場合，MACフィールド(項目6．3．3を参照)である(FFS(要検討))。
              ユーザプレーン無線ベアラに関連するPDCPエンティティに使用される暗号化アルゴリズム及び鍵は，PDCP  PDUが受信／送信された時に上位層［3］によって構成され，［6］で明記した暗号化方法が適用される。ヘッダ圧縮を使用するように構成される場合，PDCP  SDUに関連する圧縮パケットのみが，関連するCOUＮT値に基づいて暗号化／復号化される。
              制御プレーン無線ベアラに関連するPDCPエンティティに使用される暗号化アルゴリズム及び鍵は，受信される各PDCP  PDUに対して上位層［3］によって構成され，［6］で明記した暗号化方法が適用される。
              暗号化保護のためにPDCPに要求されるパラメータは［6］で定義され，暗号化アルゴリズムに入力される。上位層［3］によって提供されるPDCPに要求されるパラメータを以下に記載する。
              -  COUＮT -  BEARER(［5］で無線ベアラ識別子として定義される。［3］のように，値RBアイデンティティ  1を使用する。)
              -  DIRECTIOＮ(送信方向)
              -  CK(暗号鍵)
              -  IBS(入力ビットストリーム)」
              「5．4  完全性保護
              完全性保護機能は，制御プレーン無線ベアラに関連するPDCPエンティティに対してPDCPで実行される。
              PDCPエンティティに使用される完全性保護アルゴリズム及び鍵は，受信される各PDCP  PDUに対して上位層［3］によって構成され，［6］で明記した完全性保護方法が適用される。完全性保護のためにPDCPに要求されるパラメータは［6］で定義され，完全性保護アルゴリズムに入力される。上位層［3］によって提供されるPDCPに要求されるパラメータを以下に記載する。
              -  COUＮT -  BEARER(［6］で無線ベアラ識別子として定義される。［3］のように，値RBアイデンティティ  1を使用する。)
              -  DIRECTIOＮ(送信方向)
              -  IK(完全性保護鍵)
              -  IBS(入力ビットストリーム：暗号化又は復号化されたデータユニット(FFS(要検討)))
              -  FRESH 完全性保護を検証する場合，上記したように，UEは，入力パラメータに基づいてX-MACを計算する。計算したX-MACがMACと一致する場合，完全性保護の検査は成功したことになる。X-MACが受信したMACと一致しない場合，対応するパケットは廃棄される。」
              (以上，原文12頁19行～13頁15行・訳文1頁～2頁)
            (b) 「6．3．4  COUＮT   暗号化と完全性保護のため，COUＮT値は保持される。COUＮT値は，HFＮ及び当該PDCPシーケンス番号から構成される。」
              (原文16頁3行～5行・訳文3頁)
          b
            上記aの記載事項によれば，甲9の1には，暗号化機能は，「PDCP」(「ＮAS」よりも下位の階層(サブレイヤ))で実行され，暗号化保護のためのパラメータが暗号化アルゴリズムに入力されること，完全性保護機能も，「PDCP」で実行され，完全性保護のためのパラメータが完全性保護アルゴリズムに入力されること，暗号化及び完全性保護のためのパラメータとして，HFＮ及び当該PDCPシーケンス番号から構成される「COUＮT」が用いられることが開示されていることが認められる。
            しかるところ，甲9の1は，引用刊行物1が公開(2007年(平成19年)6月)された後に公開(同年9月)されたこと(弁論の全趣旨)からすると，上記開示事項は，引用刊行物1の公開当時，「14．1  概説及び原則」の第5原則第1文の「暗号化，及び，完全性保護のための入力」として「シーケンス番号」として，「COUＮT」が有力候補の一つとして検討されていたことをうかがわせるものであるとしても，その公開時に，「COUＮT」を採用することが決定していたことの根拠となるものではないし，同様に，第5原則第2文の「所与のあるシーケンス番号」にいう「シーケンス番号」として「COUＮT」を採用することが決定していたことの根拠となるものでもない。
            ましてや，甲9の1が，第5原則第2文が「ある所与のシーケンス番号が，(暗号化及び完全性保護に用いられる際に，)ある所与のeＮB鍵を基にして得られたUP鍵(K )及びRRC鍵(KeＮB-UP-enc eＮ，K )のために用いられるのは一度でなければB-RRC-enc eＮB-RRC-intならないこと」を意味する旨の原告主張の裏付けとなるものではない。
        (ウ) 小括
          以上によれば，第5原則第2文は，暗号化及び完全性保護の手続について述べたものであり，シーケンス番号がeＮB鍵の生成のために用いられることを述べたものではないとの原告の主張は，理由がない。
    (4) 一致点の認定の誤りの有無について
      原告は，引用発明における「シーケンス番号」には，本願発明の「ＮAS＿U＿SEQ」は含まれないから，本件審決が，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」を本願発明と引用発明の一致点と認定したのは誤りである旨主張する。
      ア
        引用刊行物1の「14．1  概説及び原則」の第5原則第2文の「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。」にいう「eＮB鍵のために使用される」とは，「eＮB鍵の生成のために」使用されることを述べたものであることは，前記(3)エ認定のとおりである。
        そして，引用刊行物1の公開時において，第5原則第1文の「シーケンス番号」及び第5原則第2文の「所与のあるシーケンス番号」にいう「シーケンス番号」として具体的にどのようなシーケンス番号を採用するかについて決定されていなかったことは，前記(3)オ(ア)及び(イ)のとおりである。
      イ
        前記(2)アの引用刊行物1の記載事項(別紙1の図4．3．2を含む。)には，UE及びMME間の「ＮAS」のサブレイヤ(レベル)，UE及びeＮB間の「RRC」，「PDCP」，「RLC」等のサブレイヤ(レベル)における「制御プレーン・プロトコル・スタック」についての記述がある。
        しかるところ，上記各サブレイヤ(レベル)で送信又は受信されるパケットに，それぞれのサブレイヤ(レベル)に対応する「シーケンス番号」が含まれることは，本願の優先権主張日当時，技術常識であったものである。
        上記技術常識に加えて，引用刊行物1には，「eＮB鍵」は，「EPC／UEにおいて，ＮAS(EPC／UE)レベルAKA手続によって生成された，鍵素材から得られる。」(第2原則)が記載されていること(前記(2)ウ)を踏まえると，引用刊行物1に接した当業者は，第5原則第2文の「eＮB鍵の生成のために」使用される「シーケンス番号」は，UE及びMME間の「ＮAS」のサブレイヤ(レベル)で送信又は受信されるパケットに含まれるシーケンス番号を意味するものと理解するものと認められる。
        そして，UEからみて上流側であるeＮBやMMEへのパケット送信をアップリンク送信，逆に，MMEやeＮBからみて下流側であるUEへのパケット送信をダウンリンク送信と称することは，本願の優先権主張日当時，技術常識であったこと(例えば，引用刊行物2(甲2の1)の段落【0043】，【0044】，【0074】)に照らすと，本願発明の「ＮAS＿U＿SEQ」は，UE及びMME間の「ＮAS」のサブレイヤ(レベル)で，UEからMMEへの「ＮASサービス要求」に係るパケットに含まれるアップリンクシーケンス番号であることは自明であるから，第5原則第2文の「eＮB鍵の生成のために」使用される「シーケンス番号」に含まれるものと整理することも許されるというべきである。
        そうすると，引用発明における「シーケンス番号」は，本願発明の「ＮAS＿U＿SEQ」を含む上位概念として整理し，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」を本願発明と引用発明の一致点と認定したことに誤りはない。
      ウ
        原告は，これに対し，①引用刊行物1には，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示はないから，引用発明は，「シーケンス番号と，および前記UEと共有される，記憶されたアクセスセキュリティ管理エンティティキーK＿ASMEから，前記セキュリティキーK＿eＮBを導出するステップ」の構成を有するものとはいえない，②引用刊行物1記載の第5原則第2文中の「A given sequence number」にいう「sequence number」とは，「COUＮT」を意味するから，「ＮAS＿U＿SEQ」とは異なるシーケンス番号である，③第5原則は，「E-UTRAＮ」すなわち「UE」と「eＮB」間のネットワークのセキュリティについて述べたものであるのに対し，「ＮAS」は，「UE」と「MME」との間のプロトコルであり，本願発明と引用発明とは，「シーケンス番号」が用いられるプロトコルが異なるから，「シーケンス番号」の意味が異なることは，当業者にとって自明であり，引用発明における「シーケンス番号」には，本願発明の「ＮAS＿U＿SEQ」は含まれない旨主張する。
        しかしながら，引用刊行物1の第5原則第2文にシーケンス番号が「eＮB鍵の生成のために」使用されることについての開示があること，引用刊行物1の「シーケンス番号」が「COUＮT」に特定又は限定されるものでないことは，前記(3)オで説示したとおりであるから，上記①及び②の点は理由がない。
        また，前記アのとおり，第5原則第2文の「eＮB鍵の生成のために」使用される「シーケンス番号」は，UE及びMME間の「ＮAS」のサブレイヤ(レベル)で送信又は受信されるパケットに含まれるシーケンス番号を意味するものといえるから，上記③の点も理由がない。
        したがって，原告の上記主張は，採用することができない。
    (5) まとめ
      以上のとおり，本件審決がした引用発明及び一致点の認定に原告主張の誤りは認められないから，原告主張の取消事由1は理由がない。
  2 取消事由2(相違点の看過)について
    (1)
      原告は，本願発明は，「ＮASサービス要求を前記UEから受信するステップ(32，52)であって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップ」の構成を有するが，本件審決は，引用発明が上記構成を有することを認定していないから，上記構成を本願発明と引用発明の相違点として認定すべきであったのに，この相違点の認定を看過した誤りがある旨主張する。
      そこで検討するに，前記1(2)イの引用刊行物1の記載事項(「7．1  サービスと機能」，「7．3  ＮASメッセージの転送)」)と図19．2．2．3(別紙1参照)を総合すると，引用刊行物1には，①「ＮASダイレクトメッセージ」が「UE」から「ＮAS」へ又は「ＮAS」から「UE」へ転送(初期直接転送)されること，②「ＮASサービスリクエスト」(ＮASサービス要求)が「UE」から「ＮAS」によって「eＮB」を経て「MME」へ送信され，「MME」がこれを受信することが記載されていることが認められる。
      そうすると，引用刊行物1には，「MME」が「ＮASサービス要求を前記UEから受信するステップ」が開示されているものといえる。
      そして，「ＮASサービス要求」のパケットにシーケンス番号(アップリンクシーケンス番号)含まれることは自明であるから，引用刊行物1には，「ＮASサービス要求を前記UEから受信するステップであって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップ」の構成が実質的に記載されているに等しいものと認められる。
      そうすると，上記構成は，本願発明と引用刊行物1記載の方法との間の相違点ではなく，むしろ一致点と認定すべきであったものといえる。
      したがって，原告の上記主張は理由がない。
    (2)
      以上によれば，本件審決に相違点の看過の誤りがあるものと認められないから，原告主張の取消事由2は理由がない。
      なお，本件審決が，本願発明の「ＮASサービス要求を前記UEから受信するステップであって，前記要求が，ＮASアップリンクシーケンス番号ＮAS＿U＿SEQを示すステップ」の構成と引用刊行物1記載の方法との関係について明示的に認定判断を示さなかったことは，不適切であったものといわざるを得ないが，この点は，審決の結論に影響を及ぼすものではない。
  3 取消事由3(相違点の容易想到性の判断の誤り)について
    (1)
      原告は，①引用刊行物1(甲1)には，「K＿eＮBを得るために，シーケンス番号が使用され」る構成についての開示がなく，また，仮に引用刊行物1に上記構成の開示があるとしても，K＿eＮBを得るためにＮASサービス要求で示される「ＮAS＿U＿SEQ」をシーケンス番号として用いることの開示はない，②同様に，引用刊行物2(甲2の1)及び本件審決が認定した周知技術(「「UE」から，「MME」に対して「RRC／ＮAS信号」を送信する点」)のいずれにおいても，ＮASサービス要求で示される「ＮAS＿U＿SEQ」をK＿eＮBの生成のために用いることについての開示や示唆はないとして，引用発明に引用刊行物2記載の発明及び本件審決が認定した構成を組み合わせても，当業者が相違点に係る本願発明の構成を容易に想到することができたものとはいえないから，本件審決における相違点の容易想到性の判断に誤りがある旨主張する。
      ア
        引用刊行物1の「14．1  概説及び原則」の第5原則第2文の「所与のあるシーケンス番号は，所与のあるeＮB鍵のために使用されるのは，(同一の再送のためを除いて)一度のみでなければならない。」にいう「eＮB鍵のために使用される」とは，「eＮB鍵の生成のために」使用されることを述べたものであることは，前記1(3)エ認定のとおりである。
        そして，当業者においては，第5原則第2文の「eＮB鍵の生成のために」使用される「シーケンス番号」は，UE及びMME間の「ＮAS」のサブレイヤ(レベル)で送信又は受信されるパケットに含まれるシーケンス番号を意味するものと理解するものと認められることは，前記1(4)イ認定のとおりである。
        加えて，引用刊行物1に，「ＮASサービスリクエスト」(ＮASサービス要求)が「UE」から「ＮAS」によって「eＮB」を経て「MME」へ送信され，「MME」がこれを受信することが記載されており，また，「ＮASサービス要求」にパケットにシーケンス番号(アップリンクシーケンス番号)(「ＮAS＿U＿SEQ」)が含まれることが自明であることは，前記2(1)認定のとおりである。
        以上によれば，引用刊行物1に接した当業者は，第5原則第2文の「eＮB鍵の生成のために」使用される「シーケンス番号」は，UE及びMME間の「ＮAS」のサブレイヤ(レベル)で送信又は受信されるパケットに含まれるシーケンス番号であることを理解し，そのようなシーケンス番号の中から，引用刊行物1記載の「ＮASサービスリクエスト」(ＮASサービス要求)に含まれるアップリンクシーケンス番号(「ＮAS＿U＿SEQ」)を選択し，これを引用発明に採用することを容易に想到することができたものと認められる。
      イ
        原告は，この点に関し，本件審決は，本願発明と引用発明との相違点は格別のものではないと判断したが，その判断に際し，本願発明がＮASアップリンクシーケンス番号ＮAS＿U＿SEQを採用して，セキュリティキーK＿eＮBを生成するため，ＮASダウンリンクシーケンス番号ＮAS＿D＿SEQ等の別個のシーケンス番号が不要であり，特別な複雑さを回避することができるという顕著な効果を奏することを考慮していないから，上記判断は誤りである旨主張する。
        しかしながら，前記ア認定のとおり，引用刊行物1に接した当業者であれば，引用発明において，「eＮB鍵の生成のために」使用される「シーケンス番号」としてＮASアップリンクシーケンス番号ＮAS＿U＿SEQの構成を採用することを容易に想到することができたものと認められ，この場合に，「ユーザ装置(11)UEと前記UEにサービスするeＮodeB(12)との間のRRC／UPトラフィックを保護するため」の「セキュリティキーK＿eＮB」の「確立」のために，ＮASダウンリンクシーケンス番号ＮAS＿D＿SEQ等の別個のシーケンス番号」を必要としないことは，上記構成を採用したことによる予想どおりの効果にすぎないものであり，格別なものではない。
        したがって，原告の上記主張は，理由がない。
    (2)
      以上によれば，引用刊行物1に基づいて相違点に係る本願発明の構成を容易に想到することができたものと認められるから，本願発明と引用発明との相違点は格別のものではないとした本件審決における相違点の容易想到性の判断は，結論において誤りはない。
      したがって，原告主張の取消事由3は理由がない。
  4 結論
    以上の次第であるから，原告主張の取消事由はいずれも理由がなく，本件審決にこれを取り消すべき違法は認められない。
    したがって，原告の請求は棄却されるべきものである。
