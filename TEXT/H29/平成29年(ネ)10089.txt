主文
  1 原判決主文第2項及び第3項を次のとおり変更する。
    (1) 控訴人は，被控訴人に対し，200万円及びこれに対する平成28年1月13日から支払済みまで年5分の割合による金員を支払え。
    (2) 被控訴人のその余の本訴請求をいずれも棄却する。
  2 控訴人のその余の控訴を棄却する。
  3 訴訟費用は，第1，2審，本訴反訴を通じてこれを5分し，その1を被控訴人の負担とし，その余を控訴人の負担とする。
  4 この判決は，第1項(1)に限り，仮に執行することができる。

事実及び理由
第1 控訴の趣旨
  1
    原判決を次のとおり変更する。
  2
    被控訴人の請求をいずれも棄却する。
  3
    被控訴人は，原判決別紙原告製品目録記載1のソフトウェア製品及び同目録記載2のシステム製品(以下，同ソフトウェア製品を「被控訴人ソフトウェア」といい，同システム製品と併せて「被控訴人製品」と総称する。)の生産，譲渡又は譲渡の申出をしてはならない。
  4
    被控訴人は，前項記載の被控訴人製品を廃棄せよ。
  5
    被控訴人は，控訴人に対し，1000万円及びこれに対する平成28年6月4日(反訴状送達の日の翌日)から支払済みまで年5分の割合による金員を支払え。
  6
    訴訟費用は，第1，2審を通じて被控訴人の負担とする。
第2 事案の概要(以下，略称は特に断らない限り原判決に従う。)
  1 事案の要旨
    (1)
      本件は，次の本訴と反訴から成る事案である。
      ア 本訴
        被控訴人が，「被控訴人ソフトウェアにおけるパスワード登録システムの使用が特許第4455666号に係る控訴人の特許権を侵害し，又は侵害するおそれがある」旨を告知・流布する控訴人の行為が不正競争防止法2条1項15号に該当する旨主張して，控訴人に対し，①同法3条1項に基づき，上記告知・流布の差止めを，②同法4条に基づき，損害賠償金の一部である1000万円及びこれに対する不法行為の日の後である平成28年1月13日(訴状送達の日の翌日)から支払済みまで民法所定の年5分の割合による遅延損害金の支払を，③不正競争防止法14条に基づき，謝罪広告の掲載を，それぞれ求める事案。
      イ 反訴
        発明の名称を「ユーザ認証方法およびユーザ認証システム」とする三つの特許(特許第4455666号，特許第4275080号，特許第3809441号。以下，「本件特許1」ないし「本件特許3」，併せて「本件各特許」という。)に係る各特許権(以下，「本件特許権1」ないし「本件特許権3」，併せて「本件各特許権」という。)を有する控訴人が，主位的に，①被控訴人による被控訴人ソフトウェアの生産，販売及び販売の申出(販売等)が，本件特許権1及び本件特許権2を侵害するものとみなされる行為(特許法101条1号，2号，4号)並びに本件特許権3を侵害する行為に当たり，②被控訴人による被控訴人製品の販売等が，本件各特許権を侵害するものとみなされる行為(特許法101条1号，2号，4号，5号)に当たると主張し，予備的に，被控訴人製品の購入者が被控訴人製品と端末装置等とを組み合わせてワンタイムパスワード導出パターンの登録方法を構築する行為等が本件各特許権の侵害に当たり，被控訴人はこれを教唆又は幇助していると主張して，被控訴人に対し，①特許法100条1項に基づき，被控訴人製品の生産，譲渡又は譲渡の申出の差止めを，②同条2項に基づき，被控訴人製品の廃棄を，③不法行為に基づく損害賠償(いずれも特許法102条3項による。)として合計2億0700万円のうち1000万円及びこれに対する不法行為後である平成28年6月4日(反訴状送達日の翌日)から支払済みまで民法所定の年5分の割合による遅延損害金の支払を，それぞれ求める事案。
    (2)
      原判決は，本訴請求の一部(虚偽事実の告知・流布の差止請求全部と損害賠償請求の一部)を認容し，その余の本訴請求と反訴請求全部を棄却したため，1審本訴被告・反訴原告である控訴人が敗訴部分を不服として，本件控訴をした。
  2 前提事実
    原判決14頁6行目の後に行を変えて次の各事実を付加するほかは，原判決「事実及び理由」第2の1(4頁7行目から14頁6行目まで)のとおりであるから，これを引用する。
    (9) 無効審判請求事件(無効2015-800218号)の審決等
      ア
        控訴人は，平成29年6月12日，上記事件において，本件特許1の特許請求の範囲につき，訂正請求をした(乙46。以下「本件訂正」ないし「本件訂正請求」といい，特に本件訂正後の本件発明1〔請求項8〕を「本件訂正発明1」という。)。
      イ
        特許庁は，同年10月25日，本件訂正を認めた上，「特許第4455666号の請求項1乃至7に係る発明についての特許を無効とする。特許第4455666号の請求項8乃至9に係る発明についての審判請求は，成り立たない。」との審決をした(甲45，乙58。以下「本件審決」という。)。
      ウ
        控訴人及び被控訴人は，それぞれ，本件審決の取消しを求める審決取消訴訟を提起した(平成29年(行ケ)第10219号，同第10221号)。
        (10) 本件訂正発明1について
      ア
        本件訂正後の特許請求の範囲請求項8の記載は，次のとおりである(下線は訂正箇所を示す。)。
        端末装置と，前記端末装置と通信回線を介して接続されたサーバとを含む，ユーザ認証に用いられるパスワードを導出するためのパスワード導出パターンの登録システムであって，
        前記端末装置は，複数の要素から構成される所定のパターンの要素のそれぞれに所定のキャラクタを割り当てた提示用パターンを表示し，これにより，前記提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促すための手段と，
        前記入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで，新たな提示用パターンを表示する処理を繰り返し，これにより，前記新たな提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促す処理を繰り返す手段と，
        前記パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す手段と， を有し，
        前記端末装置と通信回線を介して接続されたサーバは，
        前記登録が選択されたとき，前記特定されたパスワード導出パターンを登録させるための手段を備える，
        パスワード導出パターンの登録システム。
      イ
        上記記載を構成要件に分説すると，次のとおりである。
        1A：端末装置と，前記端末装置と通信回線を介して接続されたサーバとを含む，ユーザ認証に用いられるパスワードを導出するためのパスワード導出パターンの登録システムであって，
        1B：前記端末装置は，
        1B-1：複数の要素から構成される所定のパターンの要素のそれぞれに所定のキャラクタを割り当てた提示用パターンを表示し，これにより，前記提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促すための手段と，
        1B-2：前記入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで，新たな提示用パターンを表示する処理を繰り返し，
        1B-3：これにより，前記新たな提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促す処理を繰り返す手段と，
        1B-4：前記パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す手段と， を有し，
        1C：前記端末装置と通信回線を介して接続されたサーバは，前記登録が選択されたとき，前記特定されたパスワード導出パターンを登録させるための手段を備える，
        1D：パスワード導出パターンの登録システム。
        (11) 本件審決の理由の要旨(甲45，乙58)
        本件審決の理由は，要するに，①本件訂正後の請求項1ないし7に係る発明は，先願発明(甲11発明)と同一であり，同請求項8及び9に係る発明は，先願発明(甲11発明)と同一であるとはいえない，②先願発明(甲11発明)の発明者は，本件訂正後の請求項1ないし9に係る発明の発明者(P)のみではないから，特許法29条の2括弧書の例外規定(発明者が同一)は適用されない，③したがって，本件訂正後の請求項1ないし7に係る発明についての特許は，特許法29条の2の規定に違反してなされたものであり，特許法123条1項2号に該当するものとして無効とすべきであるが，同請求項8及び9に係る発明についての特許は，特許法29条の2の規定に違反してなされたものではないから，無効とすることはできない，というものである。
  3 争点及び争点に関する当事者の主張
    後記4及び5のとおり当審における当事者の主張を付加するほかは，原判決「事実及び理由」第2の2ないし4(14頁7行目から49頁13行目まで)のとおりであるから，これを引用する。
  4 控訴人の当審における主張
    【反訴について】
    (1) 本件特許1の無効論-特許法29条の2違反がないこと(争点2-1)
      ア 発明の同一性について
        (ア)
          原判決は，甲11発明に係る「明細書の記載において引用された【図4】は，認証サーバから送られるランダムパスワードについて，各座標位置に数字がランダム配置されていることを示す一例にすぎないというべきであるから，仮に，【図4】を前提に，2回の入力によって特定される座標が複数存在し得る結果になるとしても，直ちに上記初期登録の手順が否定されることにならない」と判示する。
          しかし，甲11発明に係る明細書段落【0019】【0020】の記載は，【図4】に記載された各座標位置及びそれらに割り当てられた数字を引用してランダムパスワードの位置特定方法を説明するものであり，当該明細書の記載と【図4】とを一体として解釈しなければ，甲11発明のランダムパスワード位置特定方法を理解することはできない。
          そうすると，仮に，原判決が認定するとおり，【図4】を前提に，2回の数字の入力によって特定される座標が複数存在し得る結果になるとしても，4つの各座標の位置と順番が特定されると理解できるということであるなら，甲11発明には，入力された数字に加え，別の何らかの方法が介在してランダムパスワードの位置を特定しているということになる。
          したがって，甲11発明は，入力されたキャラクタに基づいてパスワード導出パターンを特定しているとはいえず，本件発明1の「前記入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで，新たな提示用パターンを表示する処理を繰り返」す構成とは異なる構成を有する。
          よって，本件発明1と甲11発明は同一ではない。
        (イ)
          控訴人は，平成29年6月12日，本件特許1について本件訂正請求を行った。
          後記のとおり，甲11発明は，本件訂正後の請求項8の発明(本件訂正発明1)とは同一の発明ではなく，特許法29条の2本文に該当しないことは明らかである。
      イ 発明者の同一性について
        甲11発明の特徴的部分は，控訴人が原審で主張したとおり，「ユーザ認証に用いられるパスワード導出パターンの登録方法として，ユーザに乱数表等の提示用パターンを提示し，提示用パターンを構成する要素の位置と順番(すなわち，パスワード導出パターン)を任意に選択させ，当該要素に割り当てられた数字等のキャラクタを抜き出して入力させることを繰り返すことによって，認証サーバが，提示した提示用パターンと当該入力されたキャラクタに基づいてパスワード導出パターンを特定する」点にある。
        甲11発明の発明者は，かかる特徴的部分を誰がどのような過程で創作したかという観点から認定されなければならない。
        したがって，原判決が適示した，甲11公報に記載されたパスワードの初期登録方法に係る部分①ないし⑤(原判決54頁19行目から55頁3行目まで)の全てについて具体的に着想，提示した主体がPのみでなければならないとする判断手法は誤りである。
        そして，Pは，本件プロジェクト当初のＮTTコム及びベース社からの依頼に基づき(乙5，甲30)，OFFICの初期パスワード登録方法についての開発に着手し，その結果複数案をまとめた本件手順案(乙7)を作成して，これをＮTTコム及びベース社に提供していること，本件手順案に記載された方式Cが甲11発明の特徴的部分と同一の技術思想を有するものであるところ，同案の名義人が控訴人(株式会社セキュアプロバイダ)となっていること，パスワード登録方法について控訴人が複数の案を出したとQが記憶していること(乙28)，当時，控訴人はPを含め二，三人の小さなベンチャーであり(乙28)，Rは単なる営業窓口であって技術開発能力はなく(乙30)，開発能力のある者はPしかいなかったこと，同ファイルの作成者が「(省略)」となっていること等に照らせば，Pが甲11発明の特徴的部分を全て創作したことは明らかである。
        また，甲11発明の特徴的部分のような技術的思想は，OFFIC及びパスロジック方式の仕組みを熟知する者でしか発案できないものであるところ，そのような者はP以外におらず，それをQやSを始めとする本件プロジェクト関係者も理解していたからこそ，ＮTTコム及びベース社は，控訴人のPにパスワード登録方式について開発分担を依頼したのである。
        したがって，甲11発明の発明者はPのみと認定されるべきであり，これに反する原判決は誤りである。
        なお，原判決は，甲11発明の発明者がPのみであると認めるに足る証拠はないと判示した(すなわち，甲11発明はPとP以外の者の共同発明であると認定した)が，後願の特許権者に対して「先願の発明に関し，後願の発明者以外に発明者がいないこと」という消極的事実の立証責任を負担させるのは不合理である。立証上の公平及び証明の難易度の観点からは，特許法29条の2本文の適用を主張する者が，特許法29条の2本文括弧書所定の適用除外事由が認められないこと(後願の発明者が先願の発明者と同一でないこと)について主張立証責任を負担するものと解するのが相当であるから，原判決は立証責任の分配を誤っている。
      ウ
        以上の次第であるから，本件特許1に特許法29条の2違反の無効理由はない。
    (2) 本件特許1の無効論-訂正の対抗主張
      ア 本件訂正請求を行ったこと
        前記のとおり，控訴人は，本件訂正請求を行った。
      イ 本件訂正が特許法134条の2第1項，126条5項及び6項の訂正要件を満たすこと
        (ア) 本件訂正の目的
          本件訂正は，本件発明1に関していえば，「前記入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで，新たな提示用パターンを表示する処理を繰り返し，これにより，前記新たな提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促す処理を繰り返す手段と，」の後に，「前記パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す手段と，」との構成要件を直列的に付加するものであり，さらに，「前記特定されたパスワード導出パターンを登録させるための手段を備える，」を，「前記登録が選択されたとき，前記特定されたパスワード導出パターンを登録させるための手段を備える，」として，パスワード導出パターンが登録される条件を具体的に限定するものである。したがって，当該訂正は，特許法134条の2第1項ただし書1号に規定する特許請求の範囲の減縮を目的とするものである。
        (イ) 本件訂正は明細書等に記載された事項の範囲内であること
          「前記パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す手段と，」との訂正は，願書に添付した明細書及び図面，すなわち，本件明細書1(甲2)の「携帯電話機13は，該当要素を絞り込むことができたため，図20に示すような登録確認画面を提示して，ユーザに確認を促す(STEP1806)。この5画面に対して，ユーザが「OK」ボタン201を選択すると，携帯電話機13は，要素のシーケンスをパスワード導出パターンとして認証サーバ12に送信する。一方，ユーザが「やり直し」ボタン202を選択すると，携帯電話機13は，パスワード導出パターンの登録処理を最初からやり直す。」(【0093】)との記載及び図20の記載に基づくものである。
          また，「前記登録が選択されたとき，前記特定されたパスワード導出パターンを登録させるための手段を備える，」との訂正は，本件明細書1(甲2)の「そして，ユーザによって例えば「OK」ボタンが選択された場合には(STEP1807のYes)，携帯電話機13は，要素のシーケンスをパスワード導出パターンとして登録するため，登録要求を認証サーバ12に送信し(STEP1806)，処理を終了する。」(【0089】)との記載に基づくものである。
          したがって，本件訂正は，願書に添付した明細書，特許請求の範囲又は図面に記載した事項の範囲内においてされたものである。
        (ウ) 本件訂正は，実質上特許請求の範囲を拡張し，又は変更するものではないこと
          本件訂正は，従前の請求項8をより限定したものであるから，特許請求の範囲を拡張し，又は変更するものではない。
        (エ)
          以上のとおり，本件訂正は，特許法134条の2第1項，134条の2第9項で準用する特許法126条5項及び6項の訂正要件を満たすものである。
      ウ 本件訂正により，無効理由が解消すること
        (ア) 特許法29条の2について
          本件訂正発明1は，「パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す手段」という構成を有する。
          一方，甲11公報には，本件訂正発明1の上記構成に関する記載及び画像等の開示も示唆もない。かえって，本件訂正発明1のような確認画面の構成を備えていないため，図4によれば2回の入力ではパスワード導出パターンが1パターンに特定できていないにもかかわらず，パスワード導出パターンが1パターンに特定されたものとして説明されている。
          したがって，甲11発明は，本件訂正発明1と同一の発明ではなく，特許法29条の2本文に該当しないことが明らかであり，本件訂正によって被控訴人主張の特許法29条の2に基づく無効理由は解消される。
        (イ) 公然実施(特許法29条1項2号)について
          本件訂正によって追加された本件訂正発明1の構成に関し，Q作成の宣誓供述書(甲19。以下「Q宣誓供述書」という。)の添付資料5(「『モバイルコネクトサービス』のご紹介」)及び6(「モバイルコネクトサービス操作説明書」)には，それぞれ登録確認画面の記載がある(以下，単に「添付資料」というときは，Q宣誓供述書に添付された添付資料1ないし7のいずれかを指す。)。
          しかしながら，添付資料5及び6は，いずれも，ＮTTコムと控訴人との間で締結された秘密保持契約(ＮTTコムと控訴人との間では，甲11発明〔出願日：平成13年6月4日〕の出願前頃に口頭で秘密保持契約が成立しており，その後，同年8月30日付けの物品売買契約書〔乙44〕において同秘密保持契約を書面化した。)に基づき，ＮTTコムと秘密保持契約を締結したユーザ又はＮTTコム内でのみ使用された文書であって，そもそも頒布された刊行物には該当せず，平成13年6月頃に本件訂正発明1をその構成に含む本件サービスが提供された事実の根拠とはなり得ない。
          また，添付資料5には，ワンタイムパスワードの導入事例として四つの例が挙げられており，そのうちの一つに「(2001年12月現在)」との記載があるが，これらはいずれも本件訂正発明1を含むワンタイムパスワードサービス提供以前の旧バージョンについての導入事例であり，導入事例の紹介ページは，いずれもモバイルコネクトに連携したシステムについての紹介であって，ワンタイムパスワードの登録方法については言及がない。
          仮に，添付資料5及び6に基づき，本件特許1の優先日以前の本件訂正発明1の公然実施が認められるとしても，それは，添付資料6の作成日付である平成13年11月以降のことであって，しかも，ＮTTコムと控訴人との間には，パスワードの登録方法に関し秘密保持契約が存在していたのであり，同秘密保持契約に反してなされたものであるから，本件訂正発明1は，控訴人の意に反して公然実施をされた発明に当たる。
          したがって，本件訂正発明1は，特許法(平成11年改正法)30条2項の適用を受け，特許法29条1項2号に該当するに至らなかったものとみなされる。
          よって，本件訂正により，被控訴人主張の特許法29条1項2号に基づく無効理由は解消される。
      エ 本件登録システムが本件訂正発明1の技術的範囲に属すること
        (ア) 本件訂正発明1の構成要件の分説
          前記第2の2で付加した(10)イのとおりである。
        (イ) 本件登録システムの構成
          本件登録システムを，本件訂正発明1の構成要件に即して分説すると以下のとおりである(以下，順に「要素1a」などという。)。
          1a：パソコン，携帯電話，スマートフォン等の端末装置と，前記端末装置と通信回線を介して接続されたセキュアマトリクス認証サーバとを含む，ユーザ認証に用いられるワンタイムパスワードを導出するパスワードとなる位置と順番の登録システムである。
          1b：パソコン，携帯電話，スマートフォン等の端末装置は，
          1b-1：マトリクス表を表示し，ユーザに，提示されたマトリクス表から，特定のマス目に割り当てられた数字を抜き出させ，その数字を入力する入力フォームを表示する表示機能部を有する。
          1b-2：入力された数字に基づいてパスワードとなる位置と順番を特定するため，新しい数字が割り当てられたマトリクス表を表示するとともに，
          1b-3：ユーザに，新たに表示されたマトリクス表から特定のマス目に割り当てられた数字を抜き出させ，その数字を入力する入力フォームを表示する再表示機能部を有する。
          1b-4：パスワードとなる位置と順番が特定されたとき，特定された位置と順番の情報が反映されたマトリクス表と，「OK」及び「キャンセル」の入力ボタンを含む登録確認画面を表示して，これにより，ユーザに対し，パスワードとなる位置と順番を登録するか又は前記表示及び入力を最初からやり直すかの選択を促す表示機能部を有する。
          1c：パソコン，携帯電話，スマートフォン等の端末装置と通信回線を介して接続されたセキュアマトリクス認証サーバは，「OK」の入力ボタンがクリックされたとき，特定されたパスワードとなる位置と順番を登録するパターン登録機能部を有する。
        (ウ) 本件登録システムの構成要件充足性
          a 構成要件1A，1B，1B-1，1B-2及び1B-3
            本件訂正前(本件発明1)の構成要件1A，1B，1B-1，1B-2及び1B-3について主張したとおりである。
          b 構成要件1B-4
            要素1b-4の「特定された位置と順番の情報が反映されたマトリクス表と，『OK』及び『キャンセル』の入力ボタンを含む登録確認画面」とは，ユーザが設定した「位置と順番」の情報がマトリクス表の上に反映されていることを確認してから，ユーザが当該「位置と順番」の登録を希望する場合には「OK」ボタンをクリックさせ(甲4，3頁「Step6」)，ユーザが登録のやり直しを希望する場合には「キャンセル」ボタンをクリックさせる登録確認画面である。これによって，ユーザにパスワードとなる位置と順番を登録するか否かの選択を促すものであるから，前記登録確認画面をユーザに表示することは，構成要件1B-4の「前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す」ことに該当する。
            したがって，要素1b-4は構成要件1B-4を充足する。
          c
            構成要件1C 本件訂正発明1の構成要件1Cは，サーバが「前記特定されたパスワード導出パターンを登録させる」のが，「前記登録が選択されたとき」であると限定された点においてのみ，本件訂正前(本件発明1)の構成要件1Cと異なる。
            しかるところ，要素1cの「『OK』の入力ボタンがクリックされたとき」とは，ユーザがパスワードとなる位置と順番の登録を希望した場合であるから，「前記登録が選択されたとき」に該当する。そして，その他の構成を充足することは本件発明1において主張したとおりであるから，結局，要素1cは構成要件1Cを充足する。
          d
            以上のとおり，本件登録システムは，本件訂正発明1の構成要件の全てを充足する。
        (エ)
          したがって，本件登録システムは，本件訂正発明1の技術的範囲に属することが明らかである。
    (3) 本件発明2の充足論-構成要件2Cの充足性(争点1-2)
      原判決は，構成要件2Cは，提示用パターンの生成主体がサーバであることを規定するとともに，サーバが自ら生成した提示用パターンをユーザに提示することを規定していると解釈して，非充足の結論を導いた。
      しかし，本件明細書2の【0084】【0085】には，明らかにサーバ単体ではなく，クライアント端末が提示用パターンを生成し，表示することを含む記載がある。そもそも，提示用パターンがユーザに提示されるのは，通信先のクライアント端末の画面上なのであるから，サーバ単体がクライアント端末による処理動作なしに提示用パターンを作成・提示することなど不可能であり，本件発明2がクライアント端末による画面の生成・提示を予定していることは当然のことである。
      したがって，構成要件2Cは，サーバがクライアント端末に対して，提示用パターンをユーザに提示してキャラクタの入力を促す旨の指示をしていれば足りると解すべきであり，原判決の解釈は誤っている。
      そして，本件登録システム方法は，クライアント端末が，認証サーバにおいて生成され，かつ送信された「パスワード変更用Seed」を，ユーザIDと組み合わせてマトリクス表を生成し，ユーザに提示するものであり，本件発明2の実施例とは，クライアント端末側で新たに「ユーザID」と組み合わせることで乱数が特定される点のみが異なるところ，ユーザIDは，認証サーバとクライアント端末の両方で共有されている情報であるから，「パスワード変更用マトリクス」に含まれるパターン要素を決定するための「パスワード変更用Seed」のみをクライアント端末側に送信すれば，認証サーバ側で生成される「パスワード変更用マトリクス」を，クライアント端末側で再現することができる。したがって，認証サーバが「パスワード変更用Seed」を生成して送信することが，それに基づくマトリクス表をクライアント端末に提示させて，キャラクタの入力を促す旨の指示をしていることにほかならない。
      以上のとおりであるから，本件登録システム方法は，構成要件2Cを充足する。
    (4) 本件発明3の充足論-構成要件3Cの充足性(争点1-3)
      原判決は，本件全証拠を検討しても，本件ユーザ認証システムプログラムにおけるログインIDが，利用対象システムを識別する機能を有していることを認めるに足りる証拠はないから，上記ログインIDは，構成要件3Cの「システム識別情報」に該当するとはいえないとして，非充足の結論を導いた。
      しかし，原審で主張したとおり，被控訴人ソフトウェアの運用ガイド(乙35，36)には，①ユーザを識別するユーザIDに対して，認証時に使用される最大10個のログインIDを設定することができ，SMX認証サーバに登録されていないログインIDを入力すると「ログインIDが登録されていません。」と表示されるか，ダミーマトリクス表が表示されること，②ログインID(エイリアス)を複数登録することによってログインIDを使い分けられ，ユーザは，利用対象システムごとにログインIDを付与することにより，複数の利用対象システムに対して異なるパスワードポリシーのマトリクス認証システムを用いられること，③ログインIDに利用対象システムを意味するレルムを付与すれば，ログインIDのレルムによって利用対象システムを識別することができること，の3点が記載されており，これらはいずれも，ログインIDが利用対象システムを識別する機能を有することを示すものである(原判決は，上記記載を実際のシステムの使用態様を勘案して解釈すれば，ログインIDが利用対象システムを識別していることは明らかであるのに，それを考慮せず，運用ガイド〔乙35，36〕の記載文言のみで判断した点において，審理不尽の違法がある。)。
      したがって，本件ユーザ認証システムプログラムにおけるログインIDは，構成要件3Cの「システム識別情報」に該当し，その結果，本件ユーザ認証システムプログラムは構成要件3Cを充足する。
    (5) 本件発明4の充足論-構成要件4Bの充足性(争点1-4)
      本件ユーザ認証装置におけるログインIDは，構成要件3Cと同様の理由により，構成要件4Bの「システム識別情報」に該当し，その結果，本件ユーザ認証装置は構成要件4Bを充足する。
      【本訴について】
    (6) 「営業上の信用を害する」について(争点6)
      原判決は，要するに，ニフティシステムの使用は被控訴人ソフトウェアの使用を意味することのみを理由として，本件書状3，同4及び本件メール(以下「本件ニフティ宛文書」という。)が被控訴人の「営業上の信用を害するもの」に該当すると判断した。
      しかし，原判決も認めるとおり，本件ニフティ宛文書には，被控訴人に関する直接的な記載はない。さらに，同文書は，単に被控訴人ソフトウェアのユーザに対して，被控訴人ソフトウェアの使用が特許権侵害であると指摘したものではない。ニフティは「ニフティクラウド」というクラウドサービスに関する商品をITネットワーク環境市場における需要者に対して提供しており，当該商品のクラウドサービスの機能の一つとして，ワンタイムパスワード認証である「ニフティシステム」を備えていた。すなわち，ニフティは被控訴人ソフトウェアのユーザというよりは，被控訴人ソフトウェアをクラウドサービスのパーツとして用いて，新たに自己のクラウドシステム製品(ワンタイムパスワード認証を含む。)を製造・販売する，本件特許1の被疑侵害物件の製造業者そのものである。
      特に，本件書状3は，控訴人が，ニフティが独自に本件発明1等を実施するパスワード認証システムを製造・提供したものと考え，ライセンス契約の締結を提案した文書である。本件書状3では，ニフティと控訴人が，過去に秘密保持契約を締結してワンタイムパスワード製品について導入検討を行った経緯があることも併せて説明し，ライセンス契約を締結するよう申し入れている。これは，ニフティ自身がニフティシステムを製造・提供したことについて，当該行為は，例えば本件発明1を実施しているということを内容とするものであり，全くもって被控訴人が本件特許権1を侵害しているということを内容とするものではない。よって，被控訴人の「営業上の信用を害する」ものではない。
      仮に，本件書状3のような内容の文書まで，事業者が提供する製品の中間製品提供者に対する「営業の信用を害する」告知に該当するものと判断されるならば，特許権者の権利行使について，多大な委縮効果を生ぜしめる結果となる。特許権者は，侵害警告するに際し，被疑侵害物件を構成するものについて，警告先でない業者によって提供されたものであるかを調査しなければ，営業誹謗行為責任のリスクを負うことになるからである。そして，中間製品等の納入業者を外部から知ることは，被疑侵害物件の提供事業者から情報を得ない限り極めて困難であることは明らかである。したがって，単にニフティが被控訴人ソフトウェアのユーザであったことをもって，被控訴人の「営業の信用を害する」ものであると判断することは不合理である。
      また，本件書状4及び本件メールは，ニフティシステムが被控訴人ソフトウェアを使用していることを知った後に送付(送信を含む。以下同じ。)した文書であるが，いずれもニフティ自身がニフティシステムを製造・提供したことについて，当該行為は本件発明1を実施しているということを内容とするものである。
      ニフティは，IT業界における大企業であり，自己の製品を製造・販売して一般ユーザにシステムそのものを提供する事業者であるから，独自のシステムを構築してサービス提供する以上，対外的には，自社の製品に責任を持つべき存在である。また，同社の提供するシステムに権利侵害が疑われる以上，控訴人がニフティに対して本件発明1の実施をしていることを指摘することは当然のことである。
      そして，このような文書が「営業の信用を害する」告知に該当するものと判断されるならば，これもまた特許権者の権利行使を困難にさせるといわざるを得ない。例えば，中間製品提供者が対象特許権の登録国外において中間製品を製造し，これを最終製品製造者が登録国内で製造・販売している場合であっても，国内で特許権侵害が疑われる以上，当該侵害行為の主体である最終製品製造者に交渉をもつことは当然である。このときの最終製品製造者への告知が中間製品提供者の「営業の信用を害する」告知に該当するものとなれば，多くの特許権には無効理由が排除しきれない可能性が存在する以上，特許権者が権利行使をしたいと考えるときは，多額の費用をかけて世界中の文献を精査し無効理由調査を尽くすか，最終製品製造者に対し，警告やライセンス交渉等の連絡をせずに，いきなり訴訟提起をする以外には，後に不正競争行為で訴えられるリスクを回避する手段がないということになる。しかし，特許庁の審査を経て登録された特許権であるのに，権利行使するためにそのような無効理由調査が必要となるのは不合理であるし，突然訴訟を提起するよりも任意交渉を優先させたほうがビジネス上良い結果が得られることも往々にしてあることであり，「訴訟を提起すればよいのだから権利行使には問題なし」とするのは全く現実的でない。
      したがって，本件ニフティ宛文書は被控訴人の「営業の信用を害する」ものではない。
    (7) 「虚偽」について(争点7)
      そもそも，被控訴人製品は本件各特許を侵害しているから，本件各書状及び本件メールの内容は虚偽ではない。
      また，本件ニフティ宛文書の内容は，ニフティシステムが，控訴人が所有するワンタイムパスワード関連特許(例えば，本件特許1の請求項8)を使用していると認識している旨を伝えるものであるところ，ニフティシステムは，パスワード導出パターンが特定されたとき，当該特定されたパスワード導出パターンを含む登録確認画面をクライアント端末に表示して，当該画面上に，これで「申し込む」か「キャンセル」してやり直すかの選択ボタンを配置しているから(甲8)，本件訂正発明1の技術的範囲にも属する。
      さらに，本件ニフティ宛文書は，本件発明1を実施することを「例えば」として例示しているが，控訴人が所有するワンタイムパスワード関連特許を使用していることを指摘する内容である。そうすると，本件訂正後の請求項9に記載の発明につき，本件登録システムがその技術的範囲に属して同発明を実施していれば，「控訴人が所有するワンタイムパスワード関連特許たる本件特許1を使用している」といえるのであるから，本件各書状及び本件メールの内容に虚偽はないといえる。
      以上のとおりであるから，本件各書状及び本件メールの内容に虚偽はない。
    (8) 違法性・違法性阻却事由の有無について(争点8)
      ア
        原判決は，控訴人が侵害鑑定依頼をした弁理士は控訴人の当時の代理人弁理士を含めて3名にすぎないと指摘する。
        しかし，控訴人は少なくとも複数の弁理士に鑑定を依頼した上，ニフティシステムが実際に提供されていた事実を示すための事実実験公正証書(甲8)や，侵害鑑定書及びクレームチャート(甲9)といった，通知受領者において侵害判断が可能になる程度の個別具体的な資料を添付して送付しており，何らの根拠もなく単に侵害を指摘するにとどまる文書を送付したのとは一線を画する対応をしている。
        これだけの内容を伴っても，社会通念上必要と認められる範囲でないとされるならば，特許権者としてはどれだけの弁理士・弁護士に侵害鑑定依頼をすれば充分であるのか不明であるし，そのような鑑定を要求されたのでは，特許権の権利行使は困難になるといわざるを得ない。
        また，原判決は，本件特許1について無効調査した事実は認められないと指摘するが，特許庁において登録審査を経て登録されている以上，これに加えて更に権利行使に当たって無効理由調査を強制されるのは，特許権者にとって酷である。特許庁の審査の範囲外における無効理由調査をするとなれば，その範囲は国外公報・国内外の公報以外の文献等に広がることとなり，その調査には多大な時間と費用を要するからである。
        なお，控訴人は，本件特許1に対応する米国特許(乙57)について2014(平成26)年8月に登録を受けている。すなわち，本件発明1は，本件ニフティ宛文書の送付前に，米国特許庁においても登録審査を経ていたのである。
        さらに，原判決は，本件発明1は特許法29条の2に該当するから無効であるとして侵害の事実を否定しているが，これは単なる新規性や進歩性の欠如といった無効理由とは異なるものであり，しかも，その根拠となる甲11発明はそもそもPの提案した発明によるものであったから，控訴人において無効理由となるものと認知のしようがない。加えて，控訴人は，ニフティから被控訴人の存在を指摘されたのち，ニフティとの交渉を一度棚上げし，被控訴人ともライセンス交渉を行ったが(甲10)，その間，被控訴人から本件特許1について無効理由を指摘されたことは一度もなかった。
        以上によれば，控訴人は，本件ニフティ宛文書の送付に先立つ特許権侵害調査の態様において，社会通念上必要と認められる範囲の対応は尽くしているというべきである。
      イ
        原判決は，本件ニフティ宛文書の内容は，専らニフティシステムの利用が特許権侵害に該当することを前提にライセンス契約の締結を求めるというものであり，少なくとも，本件書状4及び本件メールは，控訴人が，ニフティを自社製品の製造者ではなく被控訴人ソフトウェアのユーザという第三者であることを確定的に認識した上で，同社に対して送付したものであると指摘する。
        しかし，ライセンス契約の交渉において，対象製品が特許権の実施品でなければ，ライセンス契約の締結など求められないのは当然なのであるから，専らニフティシステムの利用が特許権侵害に該当することを前提にライセンス契約の締結を求めることが，正当な権利行使の一環とならない理由はない。
        また，本件書状3は，控訴人が，被控訴人ソフトウェアが介在していたことを認識しないで送付したものであるから，その意味でも，正当な権利行使の一環でないとする理由がない。
        そもそも，(中間製品を誰がどこで製造しているか把握していたとしても，)特許権の効力が及ぶ域内での特許権侵害が疑われる場合に当該侵害行為の主体である最終製品製造者に交渉を持つことは当然であって，これが正当な権利行使の一環でないとされるならば，特許権の権利行使に大きな委縮効果が生じる。
      ウ
        以上のとおりであるから，控訴人による本件ニフティ宛文書の送付は，社会通念上必要と認められる範囲のものであり，また，正当な権利行使の一環として，違法性が阻却されるべき行為である。
    (9) 過失の有無について(争点9)
      前記のとおり，控訴人は，本件ニフティ宛文書の送付に当たり，社会通念上必要と認められる以上に侵害鑑定を丁寧に行った上で，ニフティにも根拠を示して通知を行った。また，無効理由は単なる新規性や進歩性の欠如とは異なる無効理由であって，その対象発明となる甲11発明の発明経緯に照らせば，控訴人にはPが甲11発明の発明者であると信じるに足りる相当な理由があったというべきである。さらに，ニフティから被控訴人の存在を指摘された後，ニフティとの交渉を一度棚上げし，被控訴人ともライセンス交渉を行ったが(甲10)，その間，被控訴人から本件特許1について無効理由を指摘されたことは一度もなかった。
      以上の事情に照らせば，控訴人が本件ニフティ宛文書を送付した行為に過失はない。
      (10) 損害額について(争点10)
      原判決は，無形損害について，被控訴人の主張する額である100万円を具体的な理由もなく認容したが，ニフティは本件ニフティ宛文書を受領しても，特に被控訴人との取引を中止したものではないし，他に特に被控訴人の信用が毀損されたことを裏付ける具体的証拠もない。したがって，無形損害は生じていない。
      また，仮に，無形損害が100万円であると認められるならば，本件の弁護士・弁理士費用として相当因果関係が認められる額は，せいぜい10万円である。
  5 被控訴人の当審における主張
    【反訴について】
    (1) 本件特許1の無効論-特許法29条の2違反がないこと(争点2-1)について
      控訴人の主張は否認ないし争う。
    (2) 本件特許1の無効論-訂正の対抗主張について
      控訴人の主張は争う。訂正の対抗主張は成立しない。理由は以下のとおりである。
      ア 本件訂正によっても無効理由は解消しない
        (ア) 特許法29条の2違反
          本件訂正に係る訂正事項(以下「本件訂正事項」という。)は，入力内容を登録する際に行われている周知慣用技術にすぎず，甲11公報に明示的記載はなくても，甲11発明の実施において当業者であれば当然に行うことである。言い換えれば，本件訂正事項は，本件発明1に対して何らの技術的意義を有するものではなく，本件訂正発明1は，原判決において甲11発明と同一と認定されている本件発明1と実質的に同一である。
          したがって，本件訂正によっても特許法29条の2違反の無効理由は解消しない。
        (イ) 特許法38条違反
          本件訂正発明1は，ＮTTコムの本件サービスの開発に係る本件プロジェクトの過程においてなされたものであり，控訴人代表者であるPに加え，ＮTTコムの社員であるQやT，さらには，プロジェクト参加企業の社長であるS等が発明に関与していることは明らかである(このことは，原判決が明確に認定するとおりである。)。
          それにもかかわらず，控訴人はPによる単独発明として，他の発明者から特許を受ける権利を譲り受けることなく本件特許1を出願している。
          この点について，Qは，本件プロジェクトはＮTTコムのものとして，その費用の下でなされたのであり，その成果はＮTTコムに帰属し，第三者に譲渡されるものではないことを確認している。
          したがって，本件特許1の出願には共同出願要件(特許法38条)違反が存在し，同法123条により無効とされるべきものである(本件訂正はかかる無効理由を解消するものではない。)。
        (ウ) 公然実施(特許法29条1項2号)
          a
            原審で主張したとおり，本件特許の優先日である平成14年2月13日より前に，本件発明1と同一のパスワード登録方法を備えたモバイルコネクトがＮTTコムによって提供されていたことは明らかであるから，本件発明1は公然実施(特許法29条1項2号)を理由に，特許法123条によって無効とされるべきものである。
            そして，本件訂正発明1が本件発明1と実質的に同一であることは前記のとおりであるから，本件訂正によっても公然実施(特許法29条1項2号)の無効理由は解消しない。
          b 控訴人の主張について
            控訴人は，添付資料5で紹介されている導入事例について，いずれも本件訂正発明1を含むワンタイムパスワードサービス提供以前の旧バージョンの導入事例であるし，導入事例の紹介ページは，いずれもモバイルコネクトに連携したシステムについての紹介であって，ワンタイムパスワードの登録方法については言及がないなどと主張する。
            しかし，添付資料5の12，13頁に「MCOP…とは？」「MCOPの操作概要」としてパスワードの登録方法が明確に説明されていることに鑑みると，導入事例として紹介される4社は，いずれも，12～13頁で紹介されるようなMCOPの構成を採用している事例であることは明らかである。
            また，控訴人は，ＮTTコムと控訴人の間に秘密保持契約が存在し，ＮTTコムも顧客に秘密保持義務を課していたことを前提とした主張をするが，いずれも事実に反するものであり，理由がない。
            したがって，本件訂正発明1が控訴人の意に反して公然実施された発明であるとの主張も失当である。
      イ 本件登録システムは本件訂正発明1の技術的範囲に属しない
        本件発明1について主張したとおり，そもそも，本件登録システムは，本件発明1の構成要件1B-2及び1B-3を充足しない(そして，本件訂正事項は，構成要件1B-4及び1Cに係るものであって，構成要件1B-2及び1B-3に係る構成は本件訂正発明1においても全く同一であるから，本件登録システムは，本件訂正発明1の構成要件1B-2及び1B-3についても充足しない。)。
        したがって，本件登録システムは，本件訂正発明1の技術的範囲に属しない。
    (3) 本件発明2の充足論-構成要件2Cの充足性(争点1-2)について
      控訴人の主張は争う。控訴人の主張は，明らかに特許請求の範囲の文言に反しており，理由がない。
    (4) 本件発明3の充足論-構成要件3Cの充足性(争点1-3)について
      控訴人の主張は争う。クライアント端末で入力され，SMX認証サーバが受け取るログインIDは，ユーザを識別するもので，利用システムごとに異なるものではないから，本件発明3の利用対象となるシステムを識別するためのシステム固有の情報である「システム識別情報」には当たらない。SMX認証サーバは，対象の利用システムを特定することなく，1組のログインID及びパスワードのみによって，複数の利用システムに関するユーザ認証を行うものである。
      したがって，原判決が認定するとおり，本件ユーザ認証システムプログラムは，構成要件3Cを明らかに充足しない。
    (5) 本件発明4の充足論-構成要件4Bの充足性(争点1-4)について
      控訴人の主張は争う。本件ユーザ認証装置におけるログインIDは，ユーザを識別するものであってシステムを識別するものではないから，構成要件4Bの「システム識別情報」に該当しない。
      【本訴について】
    (6) 「営業上の信用を害する」について(争点6)
      控訴人は，①本件ニフティ宛文書には被控訴人に関する直接的な記載がないこと，②ニフティが本件特許の被疑侵害物件の製造業者そのものであること，③本件書状3については，その送付当時控訴人はニフティ自身がニフティシステムを製造販売していると考えていたこと，④最終製品提供者に対する警告が中間製品業者の営業上の信用を害すると解釈すると，最終製品提供者に対する警告に過度な萎縮効果をもたらすこと，を理由に本件ニフティ宛文書の送付行為は被控訴人の「営業上の信用を害する」ものではないと主張する。
      しかしながら，次のとおり，控訴人の主張はいずれも理由がない。
      上記①について，控訴人も認めるように，本件書状4及び本件メールは，ニフティシステムが被控訴人ソフトウェアを使用していることを認識した上で送付したものであるから，本件ニフティ宛文書には被控訴人に関する直接的な記載がないことは，何ら関係ない。
      上記②について，ニフティが本件特許の被疑侵害物件の製造業者そのものであったとしても，警告において問題とされたのは被控訴人が提供したシステムであって，そのため控訴人とニフティとのやりとりの中で明確に被控訴人について言及されており(甲10)，被控訴人の「営業上の信用を害する」ことは明らかである。
      上記③について，甲19の内容に鑑みれば，控訴人が，本件書状3送付当時においても，ニフティが独自にニフティシステムを製造販売していると考えていたなどということはない。
      上記④について，控訴人は萎縮効果について縷々述べるが，第三者に対して警告状を送付することは被控訴人の「営業上の信用を害する」行為であり，慎重な対応を採るべきことは当然である。また，この点を措くとしても，控訴人はニフティシステムが被控訴人ソフトウェアを使用していることを認識していたのであるから，控訴人の主張する萎縮効果は本件では関係がない。
    (7) 「虚偽」について(争点7)
      本件特許1は無効であるから，被控訴人製品が，その権利を侵害することはあり得ないところ，本件ニフティ宛文書は，原判決が認定したように，被控訴人ソフトウェアが本件特許権1などの特許権を侵害する旨を被控訴人ソフトウェアのユーザに指摘する文書といえる。
      したがって，本件ニフティ宛文書の送付行為は「虚偽の事実」の告知に当たる。
    (8) 違法性・違法性阻却事由の有無について(争点8)
      控訴人は，侵害鑑定を行ったこと等を理由に，本件ニフティ宛文書の送付は，本件各特許権の正当な権利行使の一環としてなされたものであり，違法性が阻却されるなどと主張するが，理由がない。
      まず，ニフティシステムが被控訴人ソフトウェアを使用しているものであることは容易に理解でき，控訴人もこれを確認している。そして，被控訴人が控訴人に対して，被控訴人ソフトウェアは控訴人の特許権を侵害するものでないと主張しているにもかかわらず，特許権侵害であると控訴人が根拠なく確信したからといって，被控訴人以外の者に権利行使することについて違法性が阻却されないことは当然である。控訴人は，最終製品製造者との交渉が正当な権利行使の一環とされないのであれば特許権者の権利行使に大きな萎縮効果を生じさせるなどというが，ニフティシステムが被控訴人ソフトウェアを使用しているものであることは容易に理解でき，控訴人もこれを確認している以上，権利行使のためには被控訴人に対して訴訟を提起すれば足りるのであり，それをせずにニフティに対して直接権利行使を試みた以上，その権利行使に根拠がなく，告知内容が虚偽のものであれば，それが違法であることは明白である。
      また，控訴人は，侵害鑑定を行い，事実実験公正証書，侵害鑑定書及びクレームチャートといった，通知受領者において侵害判断が可能になる程度の個別具体的な資料を添付して送付していること，本件特許1に対応する米国特許が登録されていること，無効理由調査を要求することは酷であることなどを理由に，本件ニフティ宛文書の送付行為が正当な権利行使に当たる旨主張する。
      しかし，侵害鑑定は，U弁理士の意見書であるが，同弁理士は，本件特許1の出願代理人で，被控訴人に対して，控訴人側代理人の一人として，侵害主張をした者であり，その意見に客観性・公平性が存するとは認められないし，かかるU弁理士を含めても鑑定に関わった弁理士は3名にすぎない。
      また，米国特許が本件特許1に対応する特許であるか否かという点を措くとしても，米国特許が登録されようとも，登録要件や無効の基準が同一ではない以上，米国特許の登録をもって本件各特許の無効理由の調査をしないことを正当化する理由にはならない。
      さらに，控訴人は，国内外の公報及び公報以外の資料の調査による無効理由調査をさせることは酷であると主張するが，原判決が認定するように，控訴人は何らの無効調査も行った形跡がないことに問題があるのであって，控訴人の主張は失当である。また，控訴人は，本件特許1の無効理由を容易に知り得なかったというが，ＮTTコムのための開発には控訴人も参加していたというのであり，その内容については当然よく認識していたはずである。
    (9) 過失の有無について(争点9)
      上記(8)と同じ理由により，控訴人に過失があったことは明らかである。
      (10) 損害額について(争点10)
      控訴人は，被控訴人とニフティとの間の取引が中止されたわけでもなく，他に特に被控訴人の信用が毀損された具体的証拠もないとして，無形損害は発生していない旨主張する。
      しかし，信用毀損とは，信用を毀損すれば足り，具体的な取引の減少を必要とするものではない。控訴人の行為により，ニフティ及び富士通SSLが被控訴人ソフトウェア，更には被控訴人の営業に対して疑義を有するに至ったことは明らかであり，被控訴人の経済的信用は毀損されている。かかる信用の毀損によって被控訴人に生じた無形損害は100万円を下るものではない。
      また，控訴人は，信用毀損の損害が100万円であれば，相当因果関係のある弁護士・弁理士費用はせいぜい10万円である旨主張する。
      しかし，本件での弁護士・弁理士費用は，控訴人の度重なる行為により対応を迫られたことにより発生したものであって，かつ，弁護士及び弁理士の対応がなければ，信用毀損は更に拡大していたことが明らかであるから，弁護士・弁理士費用を上記信用毀損の金額の1割とする必然性は無く，原判決が認定するように，少なくとも200万円は相当因果関係のある損害といえる。
      したがって，控訴人の主張は理由がない。
第3 当裁判所の判断
  1
    当裁判所は，本訴請求は，被控訴人ソフトウェアの使用が本件特許権1を侵害する行為である旨の告知・流布の差止め，並びに損害賠償金200万円及びこれに対する遅延損害金の支払を求める限度で理由があるが，その余は理由がなく，反訴請求はいずれも理由がないものと判断する。
    その理由は，以下のとおりである。
    なお，事案に鑑み，反訴請求から先に判断する。
  2 反訴請求について
    (1) 本件特許権1に基づく請求について
      本件特許1は，次のとおり，特許法29条1項2号(公然実施)に違反してされたものであり，本件訂正によってもかかる無効理由は解消されないから，訂正による対抗主張は成立せず，したがって，控訴人は被控訴人に対し本件特許権1を行使できない。
      ア 本件サービスにおいて実施されていた発明について
        (ア)
          Q宣誓供述書(甲19)には，ＮTTコム作成に係る本件サービスの紹介書(添付資料5)と本件サービスの操作説明書(添付資料6)がそれぞれ添付されている。これらの資料によれば，本件サービスについて，次のことが認められる。
          a
            添付資料5の9，10頁によれば，ＮTTコムが提供する「モバイルコネクト」は，「携帯電話，PDA，PC等の端末から，携帯電話キャリアの回線及び専用回線，又はインターネットを介してモバイルコネクトゲートウェイサーバにアクセスし，社内システムへのアクセスを行うシステム」である。
            また，添付資料5の11頁④によれば，MCOP(Mobile Connect One-Time Password)とは，モバイルコネクトのワンタイムパスワード認証のことであり，同10頁によれば，モバイルコネクトゲートウェイサーバは，認証サーバと接続されており，認証サーバが，携帯電話，PDA，PC等の端末から，社内システムへのアクセスを行う際の認証を行うものと解される。
            したがって，「モバイルコネクト」は，「携帯電話，PDA，PC等の端末から，携帯電話キャリアの回線及び専用回線，又は，インターネットを介して，モバイルコネクトゲートウェイサーバにアクセスし，モバイルコネクトゲートウェイサーバと接続された認証サーバによりワンタイムパスワード認証をして，社内システムへのアクセスを行うシステム」であるといえる。
          b 添付資料6の9～12頁によれば，「モバイルコネクト」の利用を開始する際のワンタイムパスワード方式における乱数表の位置情報の初期登録は，次のとおり行われる。すなわち，
            携帯電話が利用開始通知メールを受信し，ユーザが利用開始通知メールで受信したパスワードエントリー用URLにアクセスして初期エントリー用パスワードを入力すると，
            携帯電話は，縦4個×横12個の数字からなる乱数表を，縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示するとともに，「乱数表の位置の数字を入力する欄」にユーザによって選択された複数の数字を入力可能とする「設定用画面その1」を表示し，
            ユーザが，携帯電話に表示されている前記乱数表に基づき，覚えやすい文字の位置の数字を入力し，「GO」を押すと，「設定用画面その1」とは異なる，縦4個×横12個の数字からなる乱数表を，縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示するとともに，「乱数表の位置の数字を入力する欄」にユーザによって選択された複数の数字を入力可能とする「設定用画面その2」を表示し，
            ユーザが，「設定用画面その2」の乱数表のうち「設定用画面その1」で入力したのと同じ位置の数字を入力し，再度「GO」を押すと，乱数表内に入力する順に数字が表示された「設定確認画面」が表示され，
            当該「設定確認画面」は，「GO」ボタンと「やりなおし」ボタンを有し，ユーザが確認して「GO」を押すと，ワンタイムパスワード方式における乱数表の位置情報の設定が行われ，やり直す場合は，「やりなおし」を押す
            ことによって，行われる。
          c
            また，添付資料5の13頁によれば，乱数表の位置情報は「認証サーバ」に設定されるものである。
        (イ)
          以上によれば，本件サービスにおける「モバイルコネクト」とは，次の構成を有するシステムであると認められる(以下，かかるシステムを「引用発明」という。)。
          携帯電話，PDA，PC等の端末から，携帯電話キャリアの回線及び専用回線，又は，インターネットを介して，モバイルコネクトゲートウェイサーバにアクセスし，モバイルコネクトゲートウェイサーバと接続された認証サーバによりワンタイムパスワード認証をして，社内システムへのアクセスを行うシステムであって，
          ワンタイムパスワード認証における乱数表の位置情報の初期登録の際に，携帯電話が利用開始通知メールを受信し，ユーザが利用開始通知メールで受信したパスワードエントリー用URLにアクセスして初期エントリー用パスワードを入力すると，
          携帯電話は，縦4個×横12個の数字からなる乱数表を，縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示するとともに，「乱数表の位置の数字を入力する欄」にユーザによって選択された複数の数字を入力可能とする「設定用画面その1」を表示し，
          ユーザが，携帯電話に表示されている前記乱数表に基づき，覚えやすい文字の位置の数字を入力し，「GO」を押すと，「設定用画面その1」とは異なる，縦4個×横12個の数字からなる乱数表を，縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示するとともに，「乱数表の位置の数字を入力する欄」にユーザによって選択された複数の数字を入力可能とする「設定用画面その2」を表示し，
          ユーザが，「設定用画面その2」の乱数表のうち「設定用画面その1」で入力したのと同じ位置の数字を入力し，再度「GO」を押すと，乱数表内に入力する順に数字が表示された「設定確認画面」が表示され，
          当該「設定確認画面」は，「GO」ボタンと「やりなおし」ボタンを有し，ユーザが確認して「GO」を押すと，認証サーバにワンタイムパスワード認証における乱数表の位置情報の設定が行われ，やり直す場合は，「やりなおし」を押す，システム。
      イ 本件発明1(本件訂正発明1)と引用発明との対比
        (ア) 構成要件1Aについて
          引用発明の「携帯電話」，「携帯電話キャリアの回線及び専用回線」は，それぞれ，本件発明1の「端末装置」，「通信回線」に相当する。
          また，引用発明の「モバイルコネクトサーバ」と「認証サーバ」とが協働するものが，本件発明1の「サーバ」に相当する。
          さらに，引用発明の「ワンタイムパスワード認証」するための「乱数表の位置情報の初期登録」は，本件発明1の「ユーザ認証に用いられるパスワードを導出するためのパスワード導出パターンの登録」に相当するから，引用発明の「システム」は，本件発明1と同様の「ユーザ認証に用いられるパスワードを導出するためのパスワード登録システム」ということができる。
          したがって，引用発明の「ワンタイムパスワード認証における乱数表の位置情報の初期登録」を行う「携帯電話，PDA，PC等の端末から，携帯電話キャリアの回線及び専用回線，又は，インターネットを介して，モバイルコネクトゲートウェイサーバにアクセスし，モバイルコネクトゲートウェイサーバと接続された認証サーバによりワンタイムパスワード認証をして，社内システムへのアクセスを行うシステム」は，本件発明1の「端末装置と，前記端末装置と通信回線を介して接続されたサーバとを含む，ユーザ認証に用いられるパスワードを導出するためのパスワード導出パターンの登録システム」に相当する。
        (イ) 構成要件1B-1について
          引用発明の「数字」，「縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示」した「縦4個×横12個の数字からなる乱数表」は，それぞれ，本件発明1の「キャラクタ」，「所定のパターンの要素のそれぞれに所定のキャラクタを割り当てた提示用パターン」に相当し，引用発明の「『乱数表の位置の数字を入力する欄』にユーザによって選択された複数の数字を入力可能」とすることは，本件発明1の「前記提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促す」ことに相当する。
          したがって，引用発明の「携帯端末装置」が，「縦4個×横12個の数字からなる乱数表を，縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示するとともに，『乱数表の位置の数字を入力する欄』にユーザによって選択された複数の数字を入力可能とする『設定用画面その1』を表示」することは，本件発明1の「端末装置」が，「複数の要素から構成される所定のパターンの要素のそれぞれに所定のキャラクタを割り当てた提示用パターンを表示し，これにより，前記提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促すための手段」を有することに相当する。
        (ウ) 構成要件1B-2，1B-3について
          引用発明は，「設定用画面その1」において，「ユーザが，携帯電話に表示されている前記乱数表に基づき，覚えやすい文字の位置の数字を入力し，『GO』を押すと，『設定用画面その1』とは異なる…乱数表を…表示するとともに，『乱数表の位置の数字を入力する欄』にユーザによって選択された複数の数字を入力可能とする『設定用画面その2』を表示」するから，引用発明の「設定用画面その2」における「『設定用画面その1』とは異なる，縦4個×横12個の数字からなる乱数表」は，本件発明1の「新たな提示用パターン」に相当する。
          また，引用発明は，「設定用画面」における「乱数表の位置の数字を入力する欄」に複数の数字を入力することを，「設定用画面その1」と「設定用画面その2」において，2回繰り返すことにより，乱数表の位置を特定しているから，「設定用画面」の「乱数表の位置情報」が特定されるまで，新たな「乱数表」を「携帯電話」が表示する処理を繰り返しているといえる。
          したがって，引用発明の「携帯電話」において，「ユーザが，携帯電話に表示されている前記乱数表に基づき，覚えやすい文字の位置の数字を入力し，『GO』を押すと，『設定用画面その1』とは異なる，縦4個×横12個の数字からなる乱数表を，縦4個×横4個からなる数字群と数字群の間に所定の記号を挿入して表示するとともに，『乱数表の位置の数字を入力する欄』にユーザによって選択された複数の数字を入力可能とする『設定用画面その2』を表示し，ユーザが，『設定用画面その2』の乱数表のうち『設定用画面その1』で入力した同じ位置の数字を入力し，再度『GO』を押す」ことは，本件発明1の「端末装置」が，「前記入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで，新たな提示用パターンを表示する処理を繰り返し，これにより，前記新たな提示用パターンについての特定の要素に割り当てられたキャラクタの入力を促す処理を繰り返す手段」を有することに相当する。
        (エ) 構成要件1B-4，1Cについて
          引用発明の「携帯電話」が，「乱数表内に入力する順に数字が表示された『設定確認画面』」を表示することは，本件訂正発明1の「前記パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示」することに相当する。
          また，引用発明において，「『GO』を押すと，認証サーバにワンタイムパスワード認証における乱数表の位置情報の設定が行われ」ることは，本件訂正発明1の「前記パスワード導出パターンを登録する」ことを選択し，「前記端末装置と通信回線を介して接続されたサーバは，前記登録が選択されたとき，前記特定されたパスワード導出パターンを登録させるための手段」を備えることに相当する。
          引用発明において，「やり直す場合は，『やりなおし』を押す」ことは，本件訂正発明1の「表示及び入力を最初からやり直す」ことに相当し，引用発明において，「『GO』ボタンと『やりなおし』ボタンを有」することは，登録か，やり直すかの選択を促しているといえる。
          したがって，引用発明における，「乱数表内に入力する順に数字が表示された『設定確認画面』が表示され，当該『設定確認画面』は，『GO』ボタンと『やりなおし』ボタンを有し，ユーザが確認して『GO』を押すと，認証サーバにワンタイムパスワード認証における乱数表の位置情報の設定が行われ，やり直す場合は，『やりなおし』を押す」ことは，本件訂正発明1の「端末装置」が，「前記パスワード導出パターンが特定されたとき，前記特定されたパスワード導出パターンを含む登録確認画面を前記無線端末装置が表示して，これにより，前記パスワード導出パターンを登録するか又は前記表示及び入力を最初からやり直すかの選択を促す手段と，を有し，前記端末装置と通信回線を介して接続されたサーバは，前記登録が選択されたとき，前記特定されたパスワード導出パターンを登録させるための手段を備える」ことに相当する。
        (オ)
          以上によれば，本件発明1(本件訂正発明1)と引用発明は，その構成が全て一致する。
      ウ 引用発明の実施時期，公然性について
        (ア)
          証拠(甲19，21)及び弁論の全趣旨によれば，次の事実が認められる。
          a
            ＮTTコムは，本件サービスに関し，甲11発明を特許出願する予定であっため，その出願(平成13年6月4日)を待って，本件サービスの提供を開始した。平成13年6月6日付けの日刊工業新聞には，「ＮTTコミュニケーションズは5日，iモード携帯電話などからイントラネットにアクセスする企業向けプラットフォームサービス『モバイルコネクト』の提供を始めた。」「第1号ユーザーは近畿通信建設。」などとする紹介記事が掲載されている(添付資料2)。
          b
            ＮTTコムは，平成13年6月頃に行われたインターロップというITショーにおいて顧客に対しカタログを配布した。同カタログの「認証画面」の画面例には，甲11公報の図3と同じ画面表示が掲載されている(添付資料4)。
          c
            添付資料5は，ＮTTコムが，平成13年6月頃から，本件サービスの導入を検討している顧客に対して，サービス内容を説明するために使用していた説明書である。
            当該資料の10頁には，「モバイルコネクトの概要」として，システム構成の概要が記載されており，同12頁には，「MCOP(Mobile  Connect  One-time  Password)とは？」として，「乱数表の位置情報での認証」等に関する説明と，認証画面として，4×12の数字のマトリクスが記載されており，同13頁には，「MCOPの操作概要」として，パスワード生成用位置情報の初期登録の方法が記載されている。
            また，同18頁には，「導入事例④：D株式会社様」として，顧客の要望や導入したシステム概要図などが記載されており，注記として，「注：トライアルユーザとして，Ezwebをお使いいただいております。(2001年12月現在)」との説明が記載されている。
          d
            日経BP社の月刊誌である「日経インターネットテクノロジー平成13年12月号」(同年11月22日発行・甲21)の99頁では，「携帯電話のアクセスを安全に」という表題の特集記事が組まれており，その中で，本件サービスのことが次のように紹介されている。
            「ＮTTコミュニケーションズの『MCOP(モバイル・コネクト・ワンタイム・パスワード)』は，ユーザー本人しか知り得ない情報をうまく利用した認証システムである。MCOPは，携帯電話の画面に表示された4行12列の数字が並ぶ表からどの位置にある数字をどのような順番で取り出すか―という情報でユーザーを認証する(図4)。…携帯電話に表示される数字は，ログインのたびに変わるため，パスワードは毎回変わることになり，ワンタイム・パスワードのメリットも備える。ネットワーク上でパスワードを盗み見られても，不正アクセスできない。現在MCOPは，ＮTTドコモのゲートウェイと企業ネットワークとを専用線などで接続し，企業内システムを携帯電話から利用可能にするシステム・インテグレーション・サービス『モバイルコネクト』のユーザーにのみ提供している。」(101，102頁)
            また，102頁の図4には，添付資料5の13頁と同一の操作画面が掲載されている。
            これらの記載内容によれば，ＮTTコムが，上記記事が掲載された平成13年11月の時点で，「携帯電話の画面に表示された4行12列の数字が並ぶ表からどの位置にある数字をどのような順番で取り出すか」というユーザ本人しか知り得ない情報を利用した認証システム(MCOP)を含む本件サービス(モバイルコネクトサービス)を既に顧客に対して提供していたことが分かる。
          e
            添付資料6は，ＮTTコムが本件サービスの提供開始当初から使用していた，導入を決めた顧客に対する操作説明書であり，当該資料の表紙には，「モバイルコネクトサービス操作説明書  2001年11月1日」との記載がある。
        (イ)
          以上のとおり，本件サービス(モバイルコネクト)は，ＮTTコムの特許出願である甲11発明に関連するサービスであって，甲11発明の出願(平成13年6月4日)を待って同サービスの提供が開始され，同出願の翌々日(同月6日)には，サービス提供の開始と第1号ユーザが近畿通信建設である旨が新聞報道されていたところ，ＮTTコムは，同月以降，顧客に対して本件サービスの導入を勧める説明を行い，遅くとも同年11月頃には，「携帯電話の画面に表示された4行12列の数字が並ぶ表からどの位置にある数字をどのような順番で取り出すか」というユーザ本人しか知り得ない情報を利用した認証システム(MCOP)を含む本件サービス(モバイルコネクトサービス)を既に顧客に対して提供していたことが認められ，これらの事実によれば，遅くとも本件特許1の優先日(平成14年2月13日)より前の平成13年11月頃には，既に引用発明が実施されていたものと認めることができる。
          また，当時，ＮTTコムが本件サービスのユーザ企業に対して本件サービスの内容につき秘密保持義務を負わせていた事実を認めるに足る的確な証拠はないところ，本件サービスに係る引用発明は，実際に使用する利用者が，携帯電話のパスワードの登録画面の表示や操作方法により，その技術内容を特定できる(引用発明は，携帯電話のパスワードの登録画面と入力操作により特定されるものであり，本件サービスを実際に使用する利用者は，携帯電話のパスワードの登録画面や入力操作が分かれば，引用発明を知ることができる)ものである。したがって，平成13年11月頃当時，本件サービスに係る引用発明は公然実施されたものということができる。
      エ 控訴人の主張について
        (ア)
          これに対し，控訴人は，添付資料5及び6は，いずれも，ＮTTコムと秘密保持契約を締結したユーザ向け又はＮTTコム内でのみ使用された文書であるから，公然実施の根拠たり得ないなどと主張する。
          しかしながら，前記のとおり，当時，ＮTTコムが本件サービスのユーザ企業に対して秘密保持義務を負わせていたことを認めるに足る的確な証拠はなく，むしろ，甲28のQ陳述書に，「BTI社(判決注：ベース社を指す。)にも，システムの確認を含めて当社に利用してもらい，宣伝のためインタビュー記事にも協力して頂きました。」とあることや，甲20のベース社のインタビュー記事，添付資料4の配布資料，甲21の技術雑誌の記事内容等を総合すると，ＮTTコムは，引用発明について，これを秘密保持の対象とするのではなく，宣伝のために積極的に公表していたことがうかがわれる。
          したがって，控訴人の上記主張は，その前提を欠くものであって，採用できないというべきである。
        (イ)
          また，控訴人は，添付資料5に挙げられたワンタイムパスワードの四つの導入事例について，これらはいずれも本件訂正発明1を含むワンタイムパスワードサービス提供以前の旧バージョンのサービスについての導入事例であるし，導入事例の紹介ページは，いずれもモバイルコネクトに連携したシステムについての紹介であって，ワンタイムパスワードの登録方法については言及していないなどと主張する。
          しかしながら，添付資料5の12，13頁には，「MCOP…とは？」「MCOPの操作概要」などとしてパスワードの登録方法が記載されているのであるから，導入事例として紹介されている4社は，いずれも，ここで紹介されているようなMCOPの構成を採用している事例であると考えるのが相当である。また，本件サービスの提供開始直後にパスワードの登録方法が変更されるというのはいかにも不自然であるし，実際にそのような事実があったことを認めるに足る的確な証拠もない。
          したがって，控訴人の上記主張も採用できない。
        (ウ)
          さらに，控訴人は，仮に本件特許1の優先日前に本件訂正発明1の公然実施が認められるとしても，ＮTTコムと控訴人との間には，パスワードの登録方法に関し秘密保持契約が存在していたのであり，当該実施はかかる秘密保持契約に反してなされたものであるから，本件訂正発明1は，控訴人の意に反して特許法29条1項2号に該当するに至ったものであるなどと主張する。
          しかしながら，そもそも，ＮTTコムと控訴人との間に控訴人主張の秘密保持契約が存在していたことを認めるに足る的確な証拠はない。
          すなわち，控訴人は，ＮTTコムと控訴人との間では，甲11発明(出願日：平成13年6月4日)の出願前頃に口頭で秘密保持契約が成立しており，その後，同年8月30日付けの物品売買契約書〔乙44〕において同秘密保持契約を書面化したなどと主張するが，かかる口頭契約の成立を裏付ける具体的な証拠は皆無であるし，そもそも企業間で，対象や範囲を具体的に特定しないまま，口頭の秘密保持契約を締結するということ自体不自然である。さらに，本件サービスの開発に係る本件プロジェクトはＮTTコムの単独事業であって，控訴人との共同開発ではないのであるから，本件サービスの開発において得られた成果物は，ＮTTコムに帰属するべきものであり，その成果物の一つである認証システムに関して，(孫請け)受注者である控訴人に対し，発注者であるＮTTコムが，秘密保持義務を負うとは直ちに考え難い。
          また，上記物品売買契約書には，「第17条(機密の保全)1．甲は契約プログラム等のすべてについて乙の書面による事前の承諾がない限り，如何なる形においてもその内容を第三者に対して公開もしくは開示してはならないものとし，且つ漏洩を防止するものとする。」(判決注：甲はＮTTコム，乙は控訴人を指す。)との条項があるが，当該契約書を参照しても，売買契約(ライセンス)の対象となった「ワンタイムパスワードソフトウェア(OFFIC)」と引用発明との関係は不明であるし，仮に「ワンタイムパスワードソフトウェア(OFFIC)」が引用発明を含むものであったとしても，飽くまでソフトウェアに関する売買契約(実態はライセンス契約)であることからすると，前記条項の「契約プログラム等のすべて」とは，「ワンタイムパスワードソフトウェア(OFFIC)」に係るプログラムのソースコードのことと解するのが合理的である。そして，ユーザが操作を行うための画面や操作方法は，ユーザがプログラムを使用するに当たり，プログラムを解析することなく把握できるものであるから，前記条項は，プログラムのソースコードの秘密保持義務を定めたものであって，ユーザが操作を行うための画面の表示や操作方法についてまでＮTTコムに秘密保持義務を負わせたものではないと解するのが相当である。
          そうすると，上記物品売買契約書は控訴人主張の秘密保持契約が存在していたことの裏付けとなるものではなく，ほかにＮTTコムと控訴人との間にかかる秘密保持契約が存在していたことを認めるに足る証拠はない。
          以上によれば，ＮTTコムは，本件サービスの実施に当たり，携帯電話の画面の表示や端末操作方法について，控訴人に対し秘密保持義務を負っていたとは認められず，控訴人の意に反して特許法29条1項2号に該当するに至った旨の控訴人の主張は，その前提を欠くものであって，やはり採用できないというべきである。
      オ 小括
        以上のとおり，本件発明1(本件訂正発明1)とＮTTコムの本件サービス(モバイルコネクト)に係る引用発明とは，その構成が全て一致し，かつ，引用発明は，遅くとも，本件特許1の優先日である平成14年2月13日より前の平成13年11月頃には公然実施されたものであるから，本件発明1(本件訂正発明1)は，日本国内又は外国において公然実施された発明に当たる。
        また，その実施が控訴人の意に反してなされたものとはいえないから，本件発明1は，本来，特許法29条1項2号の規定により，特許を受けることができなかったはずのものである。
        したがって，本件特許1には同号違反(公然実施)の無効理由があり，かつ，本件訂正によってもかかる無効理由は解消しないから，訂正による対抗主張は認められない。
        よって，その余の点について判断するまでもなく，本件特許権1に基づく控訴人の請求は理由がない。
    (2) 本件特許権2に基づく請求について
      ア 構成要件2Dの充足性について
        (ア)
          本件発明2の構成全体をみると，構成要件2Bは，「サーバが，複数の要素から構成される所定のパターンの要素のそれぞれに所定のキャラクタを割り当てた提示用パターンを生成する生成ステップと，」というものであり，構成要件2Cは，「サーバが，前記生成した提示用パターンを前記ユーザに提示して，前記提示パターンについての特定の要素に割り当てられたキャラクタの入力を促す入力ステップと，」というものであり，構成要件2Dは，「サーバが，前記入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで，前記生成ステップおよび前記入力ステップを繰り返す特定ステップと，」というものである。
          これらの構成要件の文言を踏まえれば，上記構成要件2Bは，提示用パターンの生成主体がサーバであることを規定し，上記構成要件2Cは，サーバが自ら生成した提示用パターンをユーザに提示することを規定し，上記構成要件2Dは，パスワード導出パターンが特定されるまで，2Bの生成ステップと2Cの入力ステップとを繰り返すことを規定するものと解される。
          そして，本件明細書2における図18のフローチャートを参照すると，STEP1804が，構成要件2Dの「パスワード導出パターンが特定される」か否かを判定することに該当し，STEP1805が，構成要件2Bの生成ステップを繰り返すことに該当し，STEP1802が，構成要件2Cの入力ステップを繰り返すことに該当するから，構成要件2Dにおいては，構成要件2Bの生成ステップと構成要件2Cの入力ステップとをパスワード導出パターンが特定されるまで繰り返すことが予定されていることを裏付けるものといえる。
        (イ)
          他方，本件登録システム方法においては，被控訴人が主張するとおり，次のとおりの構成が採られている(原判決別紙「本件登録システム方法の構成(原告主張)」参照。これに対し，控訴人が主張する構成は，具体性を欠いており，採用できない。)。
          「②  クライアント端末は，『パスワード変更用seed』を受信すると同端末にインストールされたプログラムにより，ユーザが入力するユーザIDを同『パスワード変更用seed』と組み合わせ，ユニークで，且つ当該2回分への入力結果で『ワンタイムパスワード導出ルール』が特定される『パスワード変更用マトリクス』をクライアントにおいて発生規則に従って2回分同時に(「パスワード変更用マトリクス」1回目及び2回目)発生させる。
          ③  クライアント端末は，ユーザに『パスワード変更用マトリクス』(1回目)を提示し，ユーザが登録しようとする『ワンタイムパスワード導出ルール』に基づきマトリクス表のマス目に割り当てられた数字を入力するようにユーザに促す(1回目の提示。ユーザによる1回目の入力)。
          ④  ユーザによる1回目の数字入力終了後，クライアント端末は既に発生させている『パスワード変更用マトリクス』(2回目)をユーザに提示し，『ワンタイムパスワード導出ルール』に基づきマトリクス表のマス目に割り当てられた数字の入力を促す(2回目の提示。ユーザによる2回目の入力  →  これにより「ワンタイムパスワード導出ルール」が特定される。)。」
        (ウ)
          そうすると，本件登録システム方法においては，クライアント端末は，ユーザが入力するユーザIDと，受信した「パスワード変更用seed」とを組み合わせて，「パスワード変更用マトリクス」(1回目及び2回目)を2回分同時に発生させ，「パスワード変更用マトリクス」(1回目)をユーザに提示し，数字を入力するようにユーザに促し，その後，既に発生させている「パスワード変更用マトリクス」(2回目)をユーザに提示するものである。
          したがって，本件登録システム方法は，数字の入力の前に，パスワード変更用マトリクスを，2回分同時に生成するものであって，パスワード変更用マトリクスの生成と数字の入力とを繰り返す構成とはなっていないから，構成要件2Dを充足しないというべきである。
      イ 控訴人の主張について
        これに対し，控訴人は，仮に，本件登録システム方法の構成が被控訴人主張のとおりであるとしても，本件登録システム方法は，「入力されたキャラクタに基づいてパスワード導出パターンが特定されるまで」「入力ステップ」を「繰り返」しているから，構成要件2Dを充足すると主張する。
        しかしながら，被控訴人主張の構成では，本件登録システム方法が「生成ステップ」を繰り返しているとまではいえないから，やはり構成要件2Dを充足するとはいえない。
        したがって，被控訴人主張の構成によっても本件登録システム方法の構成が構成要件2Dを充足する旨の控訴人の上記主張は，採用することができない。
      ウ 小括
        以上の次第であるから，本件登録システム方法は，構成要件2Dを充足せず，本件発明2の技術的範囲に属しない。
        よって，その余の点について判断するまでもなく，本件特許権2に基づく控訴人の請求は理由がない。
    (3) 本件特許権3に基づく請求について
      ア 本件発明3の属否(構成要件3Cの充足性)について
        (ア)
          本件ユーザ認証システムプログラムのログインIDが，構成要件3Cの「システム識別情報」に該当するか否かに関し，控訴人は，本件ユーザ認証システムプログラムにおいては，①ユーザを識別するユーザIDに対して，認証時に使用される最大10個のログインIDを設定することができ，SMX認証サーバに登録されていないログインIDを入力すると「ログインIDが登録されていません。」と表示されるか，ダミーマトリクス表が表示されること，②ログインID(エイリアス)を複数登録することによってログインIDを使い分けられ，ユーザは，利用対象システムごとにログインIDを付与することにより，複数の利用対象システムに対して異なるパスワードポリシーのマトリクス認証システムを用いられること，③ログインIDに利用対象システムを意味するレルムを付与すれば，ログインIDのレルムによって利用対象システムを識別することができることの3点を根拠として，本件ユーザ認証システムプログラムにおけるログインIDが利用対象システムを識別すると主張する。
        (イ)
          しかしながら，次のとおり，控訴人が主張する上記3点はいずれも本件ユーザ認証システムプログラムにおけるログインIDが利用対象システムを識別することの根拠となるものではない。
          a 上記①の点について
            被控訴人ソフトウェアの運用ガイド(乙36)には，「ダミーマトリクス機能は，攻撃者に対し，SMXのLoginIDの登録有無を分からないようにするための機能となります。ダミーマトリクス機能を使用していない場合にはSMXに登録されていないLoginIDを入力した際，『ログインIDが登録されていません。』と表示されますが，ダミーマトリクス機能を使用することにより，SMXに登録されていないLoginIDが入力された場合でも，ダミーのマトリクス表が表示される動作となります。」との記載があり，控訴人は，これは，ログインIDをSMX認証サーバが認識したときに，設定されたログインIDがなければそれに対応するシステムの認証に入れないということであり，ログインIDがユーザの要求する利用対象システムの認証を要するものか否かの判断要素となっていることを示すものであると主張する。
            しかしながら，上記記載は，飽くまでログインIDがSMX認証サーバに登録されているかどうかが判断されていることを示すにとどまり，ログインIDが利用対象システムを識別する機能を有することまでを意味するものではないし，実際に同機能を果たしていることを認めるに足る証拠もない。
            したがって，上記①の点に関する控訴人の主張は失当である。
          b 上記②の点について
            被控訴人ソフトウェアの運用ガイド(乙35)には，「LoginID(エイリアス)を複数登録することにより，場所や用途に応じてログインIDを使い分けることができます。」との記載があり，控訴人は，かかる記載を根拠に，あるログインIDを利用して，部署内のメンバー全員がアクセス可能な共通のシステム認証を呼び出し，またあるときは，それとは別個のログインIDを利用して，部署内の管理職しかアクセスできないシステムの認証を呼び出す，といったように，用途に応じたログインIDの使い分けが想定できる(このようなログインIDの使い分けをするとき，ログインIDは正に利用対象システムを識別する情報として機能していることとなる)と主張する。
            しかしながら，上記記載は，それのみで控訴人が主張するようなログインIDによる利用対象システムの使い分けができることの根拠となるものではなく，ほかにそのような利用ができることを認めるに足る証拠もない。
            また，仮に控訴人の主張するようなアクセスする対象を異ならせる利用が可能であったとしても，それは，被控訴人の本件ユーザ認証システムにおいては，一つの利用対象システム内で，ログインIDごとにアクセス権が異なっているということを示しているにすぎず，ログインIDが利用対象システムを識別していることには直ちに結びつかない。
            したがって，上記②の点に関する控訴人の主張も失当である。
          c 上記③の点について
            本件ユーザ認証システムプログラムに関し，前記運用ガイド(乙35)には，ユーザ新規登録の「設定項目一覧」の「UserID」欄に「ユーザのIDを入力します。レルム付きUserIDはシステムで一意の値である必要があります。レルム付きUserIDは『〔UserID〕〔レルムセパレータ〕〔レルム〕』で構成されます。」との記載があり，また，「LoginID」欄に「ユーザのLoginIDを入力します。LoginIDは認証時に使用されるIDです。レルム付きLoginIDはシステムで一意の値である必要があります。レルム付きLoginIDは『〔LoginID〕〔レルムセパレータ〕〔レルム〕』で構成されます。」との記載がある。
            また，セキュアマトリクスのカタログ(乙56)には，「④レルムによるログインIDの区別化」と題する箇所に，経理部のユーザグループにレルム名「keiri」を付与し，営業部のユーザグループにレルム名「eigyo」を付与して，ログイン時にレルムを付与することにより，ユーザを区別できることが記載されている。
            控訴人は，これらの記載を根拠に，レルム付きログインIDは，「nakamura#system1」や「nakamura#system2」のように設定することができ，このとき「#system1」「#system2」のように，ログインIDに利用対象システムを意味するレルムを付与すれば，ログインIDのレルムによって利用対象システムを識別することが可能であると主張するが，控訴人の憶測にすぎず，失当である。
            すなわち，上記カタログには，経理部の鈴木花子と営業部の鈴木太郎とを，ユーザグループごとに一意であれば，ログイン登録を同じ「suzuki」とすることができ，ログイン時にレルムを付与して，それぞれ「suzuki#keiri」「suzuki#eigyo」とすれば，ユーザを区別できるということが記載されているにすぎず，このことは，レルム又はレルム付きのログインIDが利用対象システムを識別するということまでを示すものではない。レルムは，飽くまでユーザグループを識別するものであって，利用対象システムを識別するものではなく，ほかにかかる識別が可能であることを示す証拠はないから，控訴人の主張は憶測にすぎないというべきである。
        (ウ)
          以上によれば，本件ユーザ認証システムプログラムにおけるログインIDは，飽くまで認証時に使用されるIDであって，利用対象システムを識別するものではないから，構成要件3Cの「システム識別情報」に該当するものではない。
          したがって，本件ユーザ認証システムプログラムは，構成要件3Cを充足せず，本件発明3の技術的範囲に属しない。
      イ 本件発明4の属否(構成要件4Bの充足性)について
        本件発明4は，本件発明3が「プログラム」に関する発明であるのに対し，「ユーザ認証装置」に関する発明である点において，本件発明3と相違するが，その他の構成要件は実質的に同一である。
        したがって，本件ユーザ認証システム装置は，上記アと同様の理由により，本件発明4の構成要件4Bを充足しないから，本件発明4の技術的範囲に属しない。
      ウ 小括
        以上の次第であるから，その余の点について判断するまでもなく，本件特許権3に基づく控訴人の請求は理由がない。
    (4) 反訴請求についてのまとめ
      以上のとおり，本件特許権1ないし3に基づく控訴人の請求(反訴請求)はいずれも理由がないから，これらを棄却した原判決は相当である。
      よって，本件控訴のうち反訴請求に係る部分は理由がない。
  3 本訴請求について
    (1) 「営業上の信用を害する」について
      原判決が認定するとおり，本件ニフティ宛文書は，いずれも被控訴人ソフトウェアのユーザであるニフティに対するものであって，その内容は，いずれもニフティシステムの使用が本件特許権1を侵害する行為であり，控訴人との間でライセンス契約を締結することを求めるというものである。
      加えて，本件書状3には，上記侵害の事実が存在する旨の公証人作成の事実実験公正証書(甲8)が，本件書状4には同旨の弁理士作成の鑑定意見書(甲9)がそれぞれ添付されている。そして，ニフティシステムの使用は被控訴人ソフトウェアの使用を意味するものである(弁論の全趣旨)。
      以上の事実に照らせば，本件ニフティ宛文書に被控訴人に関する直接的な記載が見当たらないことを考慮しても，同文書は，一般的な自社製品の販促文書であるということはできず，これを客観的にみれば，被控訴人ソフトウェアの使用が本件特許権1を侵害する旨を被控訴人ソフトウェアのユーザに指摘する警告文書に当たることは明らかといえる。
      したがって，本件ニフティ宛文書は，被控訴人の「営業上の信用を害する」ものに該当するというべきであり，これに反する控訴人の主張は採用できない。
    (2) 「虚偽の事実の告知」について
      上記(1)のとおり，本件ニフティ宛文書は，いずれも被控訴人ソフトウェアの使用が本件特許権1を侵害する旨を被控訴人ソフトウェアのユーザに指摘する警告文書であると解される。
      そして，前記2(1)のとおり，本件発明1に係る本件特許1には無効理由があり，本件訂正によってもかかる無効理由は解消しないものと認められるから，本件ニフティ宛文書の内容はいずれも「虚偽の事実」に当たり，したがって，これを送付する行為は「虚偽の事実の告知」に当たると認められる。
      これに対し，控訴人は，本件ニフティ宛文書の内容は虚偽ではないと主張するが，その主張は，飽くまで被控訴人ソフトウェアの使用が本件特許権1(本件訂正発明1)の侵害に当たることを前提とするものであって，その前提自体が認められないことは上記のとおりであるから，採用できない。
      また，控訴人は，本件ニフティ宛文書(本件書状3)が，本件発明1を実施することを「例えば」と表現していることを根拠として，本件登録システムは，本件訂正後の請求項9に記載の発明の技術的範囲にも属しているから，結局，本件各書状及び本件メールの内容に虚偽はないといえるなどとも主張する。
      しかしながら，本件ニフティ宛文書や同文書に添付されている鑑定意見書等の記載内容を全体としてみれば，控訴人が本件発明1の侵害を念頭に置いてこれらの文書を送付していたことは明らかであり，「例えば」の一言が入っていたからといって，全く記載がない請求項9に記載の発明についての侵害警告を含む(から虚偽でない)などと解することは相当でない。
      したがって，控訴人の上記主張もまた採用できない。
    (3) 違法性・違法性阻却事由の有無及び控訴人の過失について
      控訴人は，縷々理由を述べて，控訴人による本件ニフティ宛文書の送付は，社会通念上必要と認められる範囲のものであり，正当な権利行使の一環として違法性が阻却されるべき行為であるとか，これについて控訴人に過失はないなどと主張する。
      しかしながら，控訴人が本件ニフティ宛文書の送付に当たり無効理由の有無について何ら調査検討を行っていないことは，控訴人自身が認めているところ，本件特許権1等の出願の経緯や，ＮTTコムのプロジェクト(本件サービスの開発に係る本件プロジェクト)に控訴人自身が参画していた経緯に照らせば，本件発明1については，本件サービスや甲11発明等の関係で拡大先願(特許法29条の2)や公然実施(特許法29条1項2号)などの無効理由が主張され得ることは容易に予測できることであって，たまたま被控訴人との間の事前交渉において，かかる無効主張がなされなかったとしても，そのことだけで直ちにかかる無効理由についての調査検討を全く行わなくてもよいということにはならないというべきである。
      また，証拠(甲12の1，15の1，16の1，18等)及び弁論の全趣旨によれば，控訴人は，本件ニフティ宛文書の送付に先立つ平成22年11月頃から平成23年5月頃にかけて，数か月にわたり，被控訴人との間で，弁護士・弁理士等の専門家を交えて，被控訴人製品の使用等が本件特許1等に抵触するものであるか否かについて交渉を行っており，その後，抵触を否定する被控訴人との間で交渉が暗礁に乗り上げていたにもかかわらず，被控訴人に対して再度交渉を求めたり，あるいは，訴訟提起を行ったりすることなく，平成26年3月頃から，被控訴人の顧客等に対して控訴人とのライセンスを持ちかける文書を送付するようになり，被控訴人から同文書の送付を直ちに中止するよう求められても，これを中止するどころか，ニフティに対し，明示的な侵害警告文書である本件ニフティ宛文書を送付するに至ったものと認められる。
      上記のような事情に照らせば，本件ニフティ宛文書の送付は，特許権侵害の有無について十分な法的検討を行った上でしたものとは認められず，その経過も，要するに，被控訴人との交渉では埒が明かないことから，その取引先に対し警告文書を送ることによって，事態の打開を図ろうとした(すなわち，侵害の成否について公権的な判断を経ることなく，いわば既成事実化することによって，競争上優位に立とうとした)ものであるといえる(なお，控訴人は，本件書状3を送った時点では，ニフティが被控訴人の取引先であるとは知らなかったとも主張するが，事実経過に照らして直ちに信用することはできないし，少なくとも，本件書状4及び本件メールを送った時点では，既にこれを明確に認識していた〔甲16〕のであるから，かかる事由をもって，違法性がないとか，過失がないということもできない。)。
      このような控訴人の行為が，社会通念上必要と認められる範囲のものであり，正当な権利行使の一環として違法性が阻却されるべき行為であるといえないことは明らかであり，また，これについて控訴人に過失が認められることも明らかである。
      したがって，本件ニフティ宛文書の送付は違法であり，かつ，控訴人には少なくとも過失が認められるというべきであるから，これに反する控訴人の主張は採用できない。
    (4) 損害額について
      原判決が認定したとおり，控訴人の本件ニフティ宛文書の送付により被控訴人の営業上の信用は毀損されており，かかる信用毀損によって被控訴人に生じた損害を填補するためには，100万円の賠償を認めるのが相当である。
      他方，弁護士費用・弁理士費用の請求については，本訴に要した弁護士費用等として(本件ニフティ宛文書の送付があったからといって，直ちに無効審判請求まで行う必要が生じるわけではないことからすると，無効審判請求のための費用を直ちに相当因果関係のある損害ということはできないし，反訴の提起自体を違法と認めるに足りる証拠はない以上，反訴に要した弁護士費用等まで損害と認めることはできない。)，本訴に係る損害賠償請求の認容額や差止請求が認められていることその他本件に顕れた諸般の事情を総合考慮し，100万円を認めるのが相当である。
第4 結論
  以上の次第であるから，本訴請求は，被控訴人ソフトウェアの使用が本件特許権1を侵害する行為である旨の告知・流布の差止め，並びに損害賠償金200万円及びこれに対する遅延損害金の支払を求める限度で理由があるが，その余は理由がなく，反訴請求はいずれも理由がない。
  よって，これと異なる原判決主文第2項及び第3項を本判決主文第1項のとおり変更し，控訴人のその余の控訴を棄却することとして，主文のとおり判決する。
